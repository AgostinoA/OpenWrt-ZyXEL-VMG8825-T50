Index: p0f-3.08b/p0f.fp
===================================================================
--- p0f-3.08b.orig/p0f.fp	2017-02-13 19:12:38.594250639 +0800
+++ p0f-3.08b/p0f.fp	2017-02-13 18:32:26.907869400 +0800
@@ -1,13 +1,8 @@
+; Copyright (c) 2013 Qualcomm Atheros, Inc..
 ;
-; p0f - fingerprint database
-; --------------------------
-;
-; See section 5 in the README for a detailed discussion of the format used here.
-;
-; Copyright (C) 2012 by Michal Zalewski <lcamtuf@coredump.cx>
-;
-; Distributed under the terms and conditions of GNU LGPL.
+; All Rights Reserved.
 ;
+; Qualcomm Atheros Confidential and Proprietary.
 
 classes = win,unix,other
 
@@ -17,71 +12,6 @@
 
 [mtu]
 
-; The most common values, used by Ethernet-homed systems, PPP over POTS, PPPoA
-; DSL, etc:
-
-label = Ethernet or modem
-sig   = 576
-sig   = 1500
-
-; Common DSL-specific values (1492 is canonical for PPPoE, but ISPs tend to
-; horse around a bit):
-
-label = DSL
-sig   = 1452
-sig   = 1454
-sig   = 1492
-
-; Miscellanous tunnels (including VPNs, IPv6 tunneling, etc):
-
-label = GIF
-sig   = 1240
-sig   = 1280
-
-label = generic tunnel or VPN
-sig   = 1300
-sig   = 1400
-sig   = 1420
-sig   = 1440
-sig   = 1450
-sig   = 1460
-
-label = IPSec or GRE
-sig   = 1476
-
-label = IPIP or SIT
-sig   = 1480
-
-label = PPTP
-sig   = 1490
-
-; Really exotic stuff:
-
-label = AX.25 radio modem
-sig   = 256
-
-label = SLIP
-sig   = 552
-
-label = Google
-sig   = 1470
-
-label = VLAN
-sig   = 1496
-
-label = Ericsson HIS modem
-sig   = 1656
-
-label = jumbo Ethernet
-sig   = 9000
-
-; Loopback interfaces on Linux and other systems:
-
-label = loopback
-sig   = 3924
-sig   = 16384
-sig   = 16436
-
 ; ==================
 ; TCP SYN signatures
 ; ==================
@@ -92,146 +22,197 @@
 ; Linux
 ; -----
 
-label = s:unix:Linux:3.11 and newer
-sig   = *:64:0:*:mss*20,10:mss,sok,ts,nop,ws:df,id+:0
+label = s:unix:Linux:
 sig   = *:64:0:*:mss*20,7:mss,sok,ts,nop,ws:df,id+:0
-
-label = s:unix:Linux:3.1-3.10
-sig   = *:64:0:*:mss*10,4:mss,sok,ts,nop,ws:df,id+:0
+; First saw on DSM-312, but not exclusive to it
+sig   = *:64:0:*:mss*4,3:mss,sok,ts,nop,ws:df,id+:0
+sig   = *:64:0:*:mss*10,0:mss,sok,ts:df,id+:0
+sig   = *:64:0:*:mss*10,2:mss,sok,ts,nop,ws:df,id+:0
+sig   = *:64:0:*:mss*10,3:mss,sok,ts,nop,ws:df,id+:0
 sig   = *:64:0:*:mss*10,5:mss,sok,ts,nop,ws:df,id+:0
-sig   = *:64:0:*:mss*10,6:mss,sok,ts,nop,ws:df,id+:0
-sig   = *:64:0:*:mss*10,7:mss,sok,ts,nop,ws:df,id+:0
-
-; Fun fact: 2.6 with ws=7 seems to be really common for Amazon EC2, while 8 is
-; common for Yahoo and Twitter. There seem to be some other (rare) uses, though,
-; so not I'm not flagging these signatures in a special way.
-
-label = s:unix:Linux:2.6.x
+sig   = *:64:0:*:mss*10,9:mss,nop,nop,sok,nop,ws:df,id+:0
+sig   = *:64:0:*:mss*16,1:mss,sok,ts,nop,ws:df,id+:0
+sig   = *:64:0:*:mss*16,3:mss,sok,ts,nop,ws:df,id+:0
+sig   = *:64:0:*:mss*20,1:mss,sok,ts,nop,ws:df,id+:0
+; Sonos, TiVo
+sig   = *:64:0:*:mss*4,0:mss,sok,ts,nop,ws:df,id+:0
+sig   = *:64:0:*:mss*4,4:mss,sok,ts,nop,ws:df,id+:0
+sig   = *:64:0:*:mss*4,4:sok,ts,mss,nop,ws:df,id+:0
+sig   = *:64:0:*:mss*4,5:mss,sok,ts,nop,ws:df,id+:0
+sig   = *:64:0:*:mss*4,5:sok,ts,mss,nop,ws:df,id+:0
+sig   = *:64:0:*:mss*4,6:mss,nop,nop,sok,nop,ws:df,id+:0
 sig   = *:64:0:*:mss*4,6:mss,sok,ts,nop,ws:df,id+:0
+sig   = *:64:0:*:mss*44,1:mss,sok,ts,nop,ws:df,id+:0
+; Sling
 sig   = *:64:0:*:mss*4,7:mss,sok,ts,nop,ws:df,id+:0
-sig   = *:64:0:*:mss*4,8:mss,sok,ts,nop,ws:df,id+:0
 
-label = s:unix:Linux:2.4.x
-sig   = *:64:0:*:mss*4,0:mss,sok,ts,nop,ws:df,id+:0
+; Mac OUI = "Segate"
+label = s:unix:Linux:Segate
+sig   = *:64:0:*:mss*4,4:mss,nop,nop,sok,nop,ws:df,id+:0
+
+; Seen on a Netgear OUI and Synology OUI
+label = s:unix:Linux:PH_NetSyn
+sig   = 4:64:0:*:mss*2,6:mss,sok,ts,nop,ws:df,id+:0
+
+label = s:unix:Linux:2.x
+sig   = *:64:0:*:65535,2:mss,sok,ts,nop,ws:df,id+:0
+sig   = *:64:0:*:65535,3:mss,nop,nop,sok,nop,ws:df,id+:0
+sig   = *:64:0:*:65535,3:mss,sok,ts,nop,ws:df,id+:0
+sig   = *:64:0:*:65535,5:mss,nop,nop,sok,nop,ws:df,id+:0
 sig   = *:64:0:*:mss*4,1:mss,sok,ts,nop,ws:df,id+:0
 sig   = *:64:0:*:mss*4,2:mss,sok,ts,nop,ws:df,id+:0
 
-; No real traffic seen for 2.2 & 2.0, signatures extrapolated from p0f2 data:
-
-label = s:unix:Linux:2.2.x
-sig   = *:64:0:*:mss*11,0:mss,sok,ts,nop,ws:df,id+:0
-sig   = *:64:0:*:mss*20,0:mss,sok,ts,nop,ws:df,id+:0
-sig   = *:64:0:*:mss*22,0:mss,sok,ts,nop,ws:df,id+:0
-
-label = s:unix:Linux:2.0
-sig   = *:64:0:*:mss*12,0:mss::0
-sig   = *:64:0:*:16384,0:mss::0
-
-; Just to keep people testing locally happy (IPv4 & IPv6):
-
-label = s:unix:Linux:3.x (loopback)
-sig   = *:64:0:16396:mss*2,4:mss,sok,ts,nop,ws:df,id+:0
-sig   = *:64:0:16376:mss*2,4:mss,sok,ts,nop,ws:df,id+:0
-
-label = s:unix:Linux:2.6.x (loopback)
-sig   = *:64:0:16396:mss*2,2:mss,sok,ts,nop,ws:df,id+:0
-sig   = *:64:0:16376:mss*2,2:mss,sok,ts,nop,ws:df,id+:0
-
-label = s:unix:Linux:2.4.x (loopback)
-sig   = *:64:0:16396:mss*2,0:mss,sok,ts,nop,ws:df,id+:0
-
-label = s:unix:Linux:2.2.x (loopback)
-sig   = *:64:0:3884:mss*8,0:mss,sok,ts,nop,ws:df,id+:0
-
-; Various distinctive flavors of Linux:
+label = s:unix:Linux:3.x
+sig   = *:255:0:*:mss*10,6:mss,sok,ts,nop,ws:df,id+:0
+sig   = *:64:0:*:65535,6:mss,sok,ts,nop,ws:df,id+:0
+sig   = *:64:0:*:mss*10,1:mss,sok,ts,nop,ws:df,id+:0
+sig   = *:64:0:*:mss*10,4:mss,sok,ts,nop,ws:df,id+:0
+sig   = *:64:0:*:mss*10,6:mss,sok,ts,nop,ws:df,id+:0
+sig   = *:64:0:*:mss*10,7:mss,sok,ts,nop,ws:df,id+:0
+sig   = *:64:0:*:mss*10,8:mss,sok,ts,nop,ws:df,id+:0
 
-label = s:unix:Linux:2.6.x (Google crawler)
-sig   = 4:64:0:1430:mss*4,6:mss,sok,ts,nop,ws::0
+; Saw this first on a Boxee device
+label = s:unix:Linux:Boxee
+sig   = *:64:0:*:mss*3,6:mss,sok,ts,nop,ws:df,id+:0
+
+; Saw on a Vizio device
+label = s:unix:Linux:Vizio
+sig   = *:64:0:*:mss*4,4:sok,ts,mss,nop,ws:df,id+:0
+sig   = *:64:0:*:mss*4,5:sok,ts,mss,nop,ws:df,id+:0
+
+; Saw on a TiVo device
+label = s:unix:Linux:TiVo
+sig   = *:64:0:*:mss*3,5:mss,sok,ts,nop,ws:df,id+:0
 
-label = s:unix:Linux:(Android)
+label = s:unix:Linux:Android
+sig   = *:64:0:*:mss*4,5:mss,sok,ts,nop,ws:df,id+:0
 sig   = *:64:0:*:mss*44,1:mss,sok,ts,nop,ws:df,id+:0
 sig   = *:64:0:*:mss*44,3:mss,sok,ts,nop,ws:df,id+:0
-
-; Catch-all rules:
-
-label = g:unix:Linux:3.x
-sig   = *:64:0:*:mss*10,*:mss,sok,ts,nop,ws:df,id+:0
-
-label = g:unix:Linux:2.4.x-2.6.x
-sig   = *:64:0:*:mss*4,*:mss,sok,ts,nop,ws:df,id+:0
-
-label = g:unix:Linux:2.2.x-3.x
-sig   = *:64:0:*:*,*:mss,sok,ts,nop,ws:df,id+:0
-
-label = g:unix:Linux:2.2.x-3.x (no timestamps)
-sig   = *:64:0:*:*,*:mss,nop,nop,sok,nop,ws:df,id+:0
-
-label = g:unix:Linux:2.2.x-3.x (barebone)
-sig   = *:64:0:*:*,0:mss:df,id+:0
+sig   = *:64:0:*:65535,7:mss,sok,ts,nop,ws:df,id+:0
+sig   = *:64:0:*:65535,6:mss,sok,ts,nop,ws:df,id+:0
+sig   = *:64:0:*:65535,6:mss,nop,nop,sok,nop,ws:df,id+:0
+sig   = *:64:0:*:65535,3:mss,sok,ts,nop,ws:df,id+:0
+sig   = *:64:0:*:65535,2:mss,sok,ts,nop,ws:df,id+:0
+sig   = *:64:0:*:mss*10,9:mss,nop,nop,sok,nop,ws:df,id+:0
+sig   = *:64:0:*:mss*16,3:mss,sok,ts,nop,ws:df,id+:0
+; Samsung
+sig   = 4:64:0:*:mss*10,6:mss,nop,nop,sok,nop,ws:df,id+:0
+; LG, Android 2.3.4
+sig   = 4:64:0:*:49152,3:mss,sok,ts,nop,ws:df,id+:0
+sig   = 4:64:0:*:32768,3:mss,sok,ts,nop,ws:df,id+:0
+; Android 4
+sig   = *:64:0:*:mss*20,6:mss,sok,ts,nop,ws:df,id+:0
+; Android 2
+sig   = *:64:0:*:mss*4,3:mss,sok,ts,nop,ws:df,id+:0
+
+; Nest Thermostat, but also
+; HTC, Android 2.3.7
+label = s:unix:Linux:Nest
+sig   = 4:64:0:*:mss*3,1:mss,sok,ts,nop,ws:df,id+:0
+
+label = s:unix:Linux:Sony
+sig   = 4:64:0:*:mss*4,0:mss,sok,ts:df,id+:0
+sig   = 4:64:0:*:mss*44,0:mss,nop,ws,nop,nop,sok::0
+
+label = s:unix:Linux:Roku
+sig   = 4:64:0:*:mss*3,0:mss,sok,ts,nop,ws:df,id+:0
+sig   = 4:64:0:*:mss*3,4:mss,sok,ts,nop,ws:df,id+:0
 
 ; -------
 ; Windows
 ; -------
 
+label = s:win:Xbox:360
+sig   = 4:64:0:*:mss*25,1:mss,nop,ws,nop,nop,sok::0
+sig   = 4:64:0:*:mss*13,0:mss,nop,ws,nop,nop,sok::0
+
+label = s:win:Windows:
+sig   = *:128:0:*:32767,0:mss,nop,nop,sok:df,id+:0
+sig   = *:128:0:*:mss*33,0:mss,nop,nop,sok:df,id+:0
+sig   = *:64:0:*:8192,8:mss,nop,ws,nop,nop,sok:df,id+,ecn:0
+sig   = *:64:0:*:65535,1:mss,nop,ws,nop,nop,ts,nop,nop,sok:df,id+,ts1-:0
+
+label = s:win:Windows:7
+sig   = *:128:0:*:8192,2:mss,nop,ws,nop,nop,sok:df,id+:0
+
+label = s:win:Windows:8
+sig   = *:128:0:*:63443,6:mss,nop,ws,nop,nop,sok:df,id+:0
+
 label = s:win:Windows:XP
 sig   = *:128:0:*:16384,0:mss,nop,nop,sok:df,id+:0
+sig   = *:128:0:*:64512,0:mss,nop,nop,sok:df,id+:0
 sig   = *:128:0:*:65535,0:mss,nop,nop,sok:df,id+:0
-sig   = *:128:0:*:65535,0:mss,nop,ws,nop,nop,sok:df,id+:0
+sig   = *:128:0:*:65535,0:mss,nop,ws,nop,nop,ts,nop,nop,sok:df,id+,ts1-:0
+sig   = *:128:0:*:65535,1:mss,nop,ws,nop,nop,ts,nop,nop,sok:df,id+,ts1-:0
 sig   = *:128:0:*:65535,1:mss,nop,ws,nop,nop,sok:df,id+:0
+sig   = *:128:0:*:65535,3:mss,nop,ws,nop,nop,sok:df,id+:0
+sig   = *:128:0:*:65535,3:mss,nop,ws,nop,nop,ts,nop,nop,sok:df,id+,ts1-:0
+sig   = *:128:0:*:65535,3:mss,nop,ws,nop,nop,ts:df,id+,ts1-:0
+sig   = *:128:0:*:65535,4:mss,nop,ws,nop,nop,sok:df,id+:0
+sig   = *:128:0:*:65535,5:mss,nop,ws,nop,nop,ts,nop,nop,sok:df,id+,ts1-:0
+sig   = *:64:0:*:65535,0:mss,nop,ws,nop,nop,sok:df,id+:0
+sig   = *:64:0:*:65535,1:mss,nop,ws,nop,nop,ts:df,id+,ts1-:0
+sig   = *:64:0:*:65535,4:mss,nop,ws,nop,nop,ts,nop,nop,sok:df,id+,ts1-:0
+sig   = *:64:0:*:65535,5:mss,nop,ws,nop,nop,sok:df,id+:0
+sig   = *:64:0:*:mss*7,4:mss,sok,ts,nop,ws:df,id+:0
+
+label = s:win:Windows:
+sig   = *:128:0:*:32768,2:mss,nop,ws,nop,nop,sok:df,id+:0
+sig   = *:128:0:*:63443,8:mss,nop,ws,nop,nop,sok::0
+sig   = *:128:0:*:65535,8:mss,nop,ws,nop,nop,sok:df,id+:0
+sig   = *:128:0:*:8192,0:mss,nop,nop,sok:df,id+,ecn:0
+sig   = *:128:0:*:8192,2:mss,nop,ws,sok,ts:df,id+:0
+sig   = *:128:0:*:8192,8:mss,nop,ws,nop,nop,sok:df,id+,ecn:0
+sig   = *:32:0:*:8192,8:mss,nop,ws,nop,nop,sok:df,id+:0
+sig   = *:64:0:*:8192,2:mss,nop,ws,nop,nop,sok:df,id+:0
+sig   = *:64:0:*:8192,2:mss,nop,ws,sok,ts:df,id+:0
+
+label = s:win:Windows:
+sig   = *:128:0:*:16384,0:mss,nop,ws,nop,nop,sok:df,id+:0
+sig   = *:128:0:*:63443,6:mss,nop,ws,nop,nop,sok:df,id+:0
 sig   = *:128:0:*:65535,2:mss,nop,ws,nop,nop,sok:df,id+:0
+sig   = *:64:0:*:8192,8:mss,nop,ws,nop,nop,sok:df,id+:0
 
-label = s:win:Windows:7 or 8
+label = s:win:Windows:7/8/10
 sig   = *:128:0:*:8192,0:mss,nop,nop,sok:df,id+:0
 sig   = *:128:0:*:8192,2:mss,nop,ws,nop,nop,sok:df,id+:0
 sig   = *:128:0:*:8192,8:mss,nop,ws,nop,nop,sok:df,id+:0
-sig   = *:128:0:*:8192,2:mss,nop,ws,sok,ts:df,id+:0
+sig   = *:64:0:*:8192,8:mss,nop,ws,nop,nop,sok:df,id+:0
 
-; Robots with distinctive fingerprints:
+; -----------
+; Playstation
+; -----------
 
-label = s:win:Windows:7 (Websense crawler)
-sig   = *:64:0:1380:mss*4,6:mss,nop,nop,ts,nop,ws:df,id+:0
-sig   = *:64:0:1380:mss*4,7:mss,nop,nop,ts,nop,ws:df,id+:0
-
-; Catch-all:
-
-label = g:win:Windows:NT kernel 5.x
-sig   = *:128:0:*:16384,*:mss,nop,nop,sok:df,id+:0
-sig   = *:128:0:*:65535,*:mss,nop,nop,sok:df,id+:0
-sig   = *:128:0:*:16384,*:mss,nop,ws,nop,nop,sok:df,id+:0
-sig   = *:128:0:*:65535,*:mss,nop,ws,nop,nop,sok:df,id+:0
-
-label = g:win:Windows:NT kernel 6.x
-sig   = *:128:0:*:8192,*:mss,nop,nop,sok:df,id+:0
-sig   = *:128:0:*:8192,*:mss,nop,ws,nop,nop,sok:df,id+:0
-
-label = g:win:Windows:NT kernel
-sig   = *:128:0:*:*,*:mss,nop,nop,sok:df,id+:0
-sig   = *:128:0:*:*,*:mss,nop,ws,nop,nop,sok:df,id+:0
+label = s:other:Playstation:
+sig   = 4:64:0:*:65535,0:mss,nop,ws,sok,nop,nop,nop,nop,ts:df,id+,ts1-:0
+sig   = 4:64:0:*:65535,1:mss,nop,ws,sok,nop,nop,nop,nop,ts:df,id+,ts1-:0
+sig   = 4:64:0:*:16384,0:mss,nop,ws,sok,nop,nop,nop,nop,ts:df,id+,ts1-:0
+sig   = 4:64:0:*:65535,0:mss,nop,ws,sok,nop,nop,nop,nop,ts:df,id+:0
 
 ; ------
 ; Mac OS
 ; ------
 
-label = s:unix:Mac OS X:10.x
+label = s:unix:Mac_OS_X:10.x
+sig   = *:64:0:*:3072,0:mss,nop,ws,nop,nop,ts,sok,eol+1:df,id+:0
+sig   = *:64:0:*:4096,0:mss,nop,ws,nop,nop,ts,sok,eol+1:df,id+:0
+sig   = *:64:0:*:8192,0:mss,nop,ws,nop,nop,ts,sok,eol+1:df,id+:0
 sig   = *:64:0:*:65535,1:mss,nop,ws,nop,nop,ts,sok,eol+1:df,id+:0
 sig   = *:64:0:*:65535,3:mss,nop,ws,nop,nop,ts,sok,eol+1:df,id+:0
 
-label = s:unix:MacOS X:10.9 or newer (sometimes iPhone or iPad)
+label = s:unix:iOS:
 sig   = *:64:0:*:65535,4:mss,nop,ws,nop,nop,ts,sok,eol+1:df,id+:0
-
-label = s:unix:iOS:iPhone or iPad
+sig   = *:64:0:*:65535,3:mss,nop,ws,?30,nop,nop,ts,sok,eol+1:df,id+:0
 sig   = *:64:0:*:65535,2:mss,nop,ws,nop,nop,ts,sok,eol+1:df,id+:0
-
-; Catch-all rules:
-
-label = g:unix:Mac OS X:
-sig   = *:64:0:*:65535,*:mss,nop,ws,nop,nop,ts,sok,eol+1:df,id+:0
+sig   = *:64:0:*:65535,0:mss,sok,eol+1:df,id+:0
+sig   = *:64:0:*:32768,3:mss,nop,ws,nop,nop,ts,sok,eol+1:df,id+:0
+sig   = *:64:0:*:65535,5:mss,nop,ws,nop,nop,ts,sok,eol+1:df,id+:0
 
 ; -------
 ; FreeBSD
 ; -------
 
-label = s:unix:FreeBSD:9.x or newer
+label = s:unix:FreeBSD:9.x
 sig   = *:64:0:*:65535,6:mss,nop,ws,sok,ts:df,id+:0
 
 label = s:unix:FreeBSD:8.x
@@ -241,107 +222,135 @@
 
 label = g:unix:FreeBSD:
 sig   = *:64:0:*:65535,*:mss,nop,ws,sok,ts:df,id+:0
+sig   = *:64:0:*:32768,6:mss,nop,ws,sok,ts:df,id+:0
 
-; -------
-; OpenBSD
-; -------
-
-label = s:unix:OpenBSD:3.x
-sig   = *:64:0:*:16384,0:mss,nop,nop,sok,nop,ws,nop,nop,ts:df,id+:0
-
-label = s:unix:OpenBSD:4.x-5.x
-sig   = *:64:0:*:16384,3:mss,nop,nop,sok,nop,ws,nop,nop,ts:df,id+:0
-
-; -------
-; Solaris
-; -------
-
-label = s:unix:Solaris:8
-sig   = *:64:0:*:32850,1:nop,ws,nop,nop,ts,nop,nop,sok,mss:df,id+:0
-
-label = s:unix:Solaris:10
-sig   = *:64:0:*:mss*34,0:mss,nop,ws,nop,nop,sok:df,id+:0
-
-; -------
-; OpenVMS
-; -------
-
-label = s:unix:OpenVMS:8.x
-sig   = 4:128:0:1460:mtu*2,0:mss,nop,ws::0
-
-label = s:unix:OpenVMS:7.x
-sig   = 4:64:0:1460:61440,0:mss,nop,ws::0
-
-; --------
-; NeXTSTEP
-; --------
-
-label = s:other:NeXTSTEP:
-sig   = 4:64:0:1024:mss*4,0:mss::0
-
-; -----
-; Tru64
-; -----
-
-label = s:unix:Tru64:4.x
-sig   = 4:64:0:1460:32768,0:mss,nop,ws:df,id+:0
-
-; ----
-; NMap
-; ----
-
-label = s:!:NMap:SYN scan
-sys   = @unix,@win
-sig   = *:64-:0:1460:1024,0:mss::0
-sig   = *:64-:0:1460:2048,0:mss::0
-sig   = *:64-:0:1460:3072,0:mss::0
-sig   = *:64-:0:1460:4096,0:mss::0
-
-label = s:!:NMap:OS detection
-sys   = @unix,@win
-sig   = *:64-:0:265:512,0:mss,sok,ts:ack+:0
-sig   = *:64-:0:0:4,10:sok,ts,ws,eol+0:ack+:0
-sig   = *:64-:0:1460:1,10:ws,nop,mss,ts,sok:ack+:0
-sig   = *:64-:0:536:16,10:mss,sok,ts,ws,eol+0:ack+:0
-sig   = *:64-:0:640:4,5:ts,nop,nop,ws,nop,mss:ack+:0
-sig   = *:64-:0:1400:63,0:mss,ws,sok,ts,eol+0:ack+:0
-sig   = *:64-:0:265:31337,10:ws,nop,mss,ts,sok:ack+:0
-sig   = *:64-:0:1460:3,10:ws,nop,mss,sok,nop,nop:ecn,uptr+:0
-
-; -----------
-; p0f-sendsyn
-; -----------
-
-; These are intentionally goofy, to avoid colliding with any sensible real-world
-; stacks. Do not tag these signatures as userspace, unless you want p0f to hide
-; the responses!
-
-label = s:unix:p0f:sendsyn utility
-sig   = *:192:0:1331:1337,0:mss,nop,eol+18::0
-sig   = *:192:0:1331:1337,0:mss,ts,nop,eol+8::0
-sig   = *:192:0:1331:1337,5:mss,ws,nop,eol+15::0
-sig   = *:192:0:1331:1337,0:mss,sok,nop,eol+16::0
-sig   = *:192:0:1331:1337,5:mss,ws,ts,nop,eol+5::0
-sig   = *:192:0:1331:1337,0:mss,sok,ts,nop,eol+6::0
-sig   = *:192:0:1331:1337,5:mss,ws,sok,nop,eol+13::0
-sig   = *:192:0:1331:1337,5:mss,ws,sok,ts,nop,eol+3::0
-
-; -------------
-; Odds and ends
-; -------------
+; ---
+; Placeholders
+; ---
 
-label = s:other:Blackberry:
+label = s:other:BlackBerry:
 sig   = *:128:0:1452:65535,0:mss,nop,nop,sok,nop,nop,ts::0
+sig   = *:128:0:1452:65535,2:mss,nop,nop,sok,ws,nop,nop,nop,ts::0
+sig   = 4:64:0:*:65535,4:mss,nop,ws,sok,nop,nop,nop,nop,ts:df,id+:0
+sig   = 4:64:0:*:65535,6:mss,nop,ws,sok,nop,nop,nop,nop,ts:df,id+:0
 
 label = s:other:Nintendo:3DS
 sig   = *:64:0:1360:32768,0:mss,nop,nop,sok:df,id+:0
+sig   = 4:64:0:1360:mss*24,0:mss,nop,nop,sok:df,id+:0
 
 label = s:other:Nintendo:Wii
 sig   = 4:64:0:1460:32768,0:mss,nop,nop,sok:df,id+:0
 
-label = s:unix:BaiduSpider:
-sig   = *:64:0:1460:mss*4,7:mss,sok,nop,nop,nop,nop,nop,nop,nop,nop,nop,nop,nop,ws:df,id+:0
-sig   = *:64:0:1460:mss*4,2:mss,sok,nop,nop,nop,nop,nop,nop,nop,nop,nop,nop,nop,ws:df,id+:0
+; We know this is Nintendo, but what?
+label = s:other:Nintendo:Unknown
+sig   = 4:64:0:1360:8192,0:mss,sok,eol+1::0
+sig   = 4:64:0:1360:65535,0:mss,sok,eol+1::0
+sig   = 4:64:0:1360:65535,2:mss,sok,ws,nop,eol+1::0
+sig   = 4:64:0:536:8192,0:mss,sok,eol+1::0
+sig   = 4:64:0:536:32768,0:mss::0
+sig   = 4:64:0:536:65535,2:mss,sok,ws,nop,eol+1::0
+sig   = 4:64:0:*:8192,0:mss,sok,eol+1::0
+sig   = 4:64:0:*:8192,0:mss:seq-:0
+sig   = 4:64:0:*:32768,0:mss::0
+sig   = 4:64:0:*:65535,0:mss::0
+
+label = s:other:Sling:main
+sig   = 4:64:0:*:32000,0:mss::0
+
+label = s:other:SunPower:
+sig   = 4:64:0:1466:mss*1,0:mss:ack+:0
+sig   = 4:64:0:1466:mss*1,0:mss::0
+
+label = s:other:SiliconDust:
+sig   = 4:64:0:*:mss*1,0:mss,nop,ws::0
+sig   = 4:64:0:*:mss*1,0:mss::0
+
+; Philips Lighting
+label = s:other:Philips:Hue
+sig   = 4:255:0:*:mss*2,0:mss::0
+
+label = s:other:Yamaha:AVR
+sig   = 4:255:0:*:32767,0:mss::0
+
+; Don't solely use this one
+label = s:other:Sony:
+sig   = 4:64:0:*:mss*4,3:sok,ts,mss,nop,ws:df,id+:0
+
+; Not sure on the TTL for this one
+label = s:other:SymbianOS:9
+sig   = 4:128:0:*:mss*44,1:mss,nop,nop,ts,nop,ws,nop,nop,sok:df,id+:0
+sig   = 4:255:0:*:mss*44,1:mss,nop,nop,ts,nop,ws,nop,nop,sok:df,id+:0
+
+label = s:other:PH_Linksys:
+sig   = 4:255:0:*:16000,0:mss::0
+
+label = s:other:PH_Obihai:
+sig   = 4:80:0:*:16000,0:mss::0
+
+; Seen on HP printers, Solarcity gateway (*nix?)
+; Some HP printers only talk XMPP (xmpp.hpeprint.com)
+label = s:other:PH_1:
+sig   = 4:64:0:*:mss*6,0:mss,nop,ws,nop,nop,sok,nop,nop,ts:df,id+:0
+
+; eQ-3 (Home automation), Gigaset (VoIP Handset)
+label = s:other:PH_2:
+sig   = *:128:0:*:mss*3,0:mss:df,id+:*
+
+; Seen on an Apple OUI
+label = s:other:PH_Apple:
+sig   = 4:64:0:*:32768,0:mss,nop,ws,sok,nop,nop,nop,nop,ts:df,id+,ts1-:0
+
+; Seen on a Kodak? device (Wanlida OUI)
+label = s:other:PH_Kodak:
+sig   = 4:255:0:*:12288,0:mss:df,id+:0
+
+; Seen in a Motorola FiOS TV Set top box
+label = s:other:PH_Motorola:
+sig   = 4:64:0:*:mss*13,0:mss,nop,nop,sok,nop,nop,ts:df,id+:0
+
+; Saw on a Vonage VDV22, guessing
+label = s:unix:OpenBSD:Vonage
+sig   = 4:64:0:*:16384,0:mss,nop,ws,nop,nop,ts:df,id+:0
+
+; Saw on a Shenzhen Smarteye Digital
+label = s:other:PH_Smarteye:
+sig   = 4:64:0:*:mss*1,0:mss,sok,ts,nop,ws:df,id+:0
+
+; La Crosse Technology
+label = s:other:LaCrosse:
+sig   = 4:255:0:*:mss*4,0:mss::0
+
+; Arcadyan Technology Corporation
+label = s:other:PH_Arcadyan:
+sig   = 4:64:0:*:mss*4,2:sok,ts,mss,nop,ws:df,id+:0
+
+; Saw on a Wii U and a Slingbox
+; Also seen on a Sony STR-DN1030 Wi-Fi Network A/V Receiver
+label = s:other:PH_NinSling:
+sig   = 4:64:0:*:8192,0:mss::0
+
+; Frontier Silicon Radio (Noxon?)
+label = s:other:PH_Frontier:
+sig   = 4:60:0:1460:0,0:mss,ws,eol+0::0
+sig   = 4:255:0:1460:16384,0:mss::0
+
+; Saw on ADEMCO (only)
+label = s:other:PH_ADEMCO:
+sig   = 4:128:0:1460:1536,0:mss,eol+3:df,id+:0
+sig   = 4:128:0:1460:1540,0:mss,eol+3:df,id+:0
+
+; Slim Devices
+label = s:other:PH_Slim:
+sig   = *:64:0:*:4096,0:mss::0
+
+; Oregon Scientific (weird!)
+label = s:other:PH_Oregon:
+sig   = 4:128:0:536:100,0:mss::0
+sig   = 4:128:0:536:256,0:mss::0
+
+; HomeWizard
+label = s:other:PH_HomeWizard:
+sig   = 4:255:0:1500:2048,0:mss::0
 
 ; ======================
 ; TCP SYN+ACK signatures
@@ -349,243 +358,28 @@
 
 [tcp:response]
 
-; -----
-; Linux
-; -----
-
-; The variation here is due to ws, sok, or ts being adaptively removed if the
-; client initiating the connection doesn't support them. Use tools/p0f-sendsyn
-; to get a full set of up to 8 signatures.
-
-
-label = s:unix:Linux:3.x
-sig   = *:64:0:*:mss*10,0:mss:df:0
-sig   = *:64:0:*:mss*10,0:mss,sok,ts:df:0
-sig   = *:64:0:*:mss*10,0:mss,nop,nop,ts:df:0
-sig   = *:64:0:*:mss*10,0:mss,nop,nop,sok:df:0
-sig   = *:64:0:*:mss*10,*:mss,nop,ws:df:0
-sig   = *:64:0:*:mss*10,*:mss,sok,ts,nop,ws:df:0
-sig   = *:64:0:*:mss*10,*:mss,nop,nop,ts,nop,ws:df:0
-sig   = *:64:0:*:mss*10,*:mss,nop,nop,sok,nop,ws:df:0
-
-label = s:unix:Linux:2.4-2.6
-sig   = *:64:0:*:mss*4,0:mss:df:0
-sig   = *:64:0:*:mss*4,0:mss,sok,ts:df:0
-sig   = *:64:0:*:mss*4,0:mss,nop,nop,ts:df:0
-sig   = *:64:0:*:mss*4,0:mss,nop,nop,sok:df:0
-
-label = s:unix:Linux:2.4.x
-sig   = *:64:0:*:mss*4,0:mss,nop,ws:df:0
-sig   = *:64:0:*:mss*4,0:mss,sok,ts,nop,ws:df:0
-sig   = *:64:0:*:mss*4,0:mss,nop,nop,ts,nop,ws:df:0
-sig   = *:64:0:*:mss*4,0:mss,nop,nop,sok,nop,ws:df:0
-
-label = s:unix:Linux:2.6.x
-sig   = *:64:0:*:mss*4,*:mss,nop,ws:df:0
-sig   = *:64:0:*:mss*4,*:mss,sok,ts,nop,ws:df:0
-sig   = *:64:0:*:mss*4,*:mss,nop,nop,ts,nop,ws:df:0
-sig   = *:64:0:*:mss*4,*:mss,nop,nop,sok,nop,ws:df:0
-
-; -------
-; Windows
-; -------
-
-label = s:win:Windows:XP
-sig   = *:128:0:*:65535,0:mss:df,id+:0
-sig   = *:128:0:*:65535,0:mss,nop,ws:df,id+:0
-sig   = *:128:0:*:65535,0:mss,nop,nop,sok:df,id+:0
-sig   = *:128:0:*:65535,0:mss,nop,nop,ts:df,id+,ts1-:0
-sig   = *:128:0:*:65535,0:mss,nop,ws,nop,nop,sok:df,id+:0
-sig   = *:128:0:*:65535,0:mss,nop,ws,nop,nop,ts:df,id+,ts1-:0
-sig   = *:128:0:*:65535,0:mss,nop,nop,ts,nop,nop,sok:df,id+,ts1-:0
-sig   = *:128:0:*:65535,0:mss,nop,ws,nop,nop,ts,nop,nop,sok:df,id+,ts1-:0
-
-sig   = *:128:0:*:16384,0:mss:df,id+:0
-sig   = *:128:0:*:16384,0:mss,nop,ws:df,id+:0
-sig   = *:128:0:*:16384,0:mss,nop,nop,sok:df,id+:0
-sig   = *:128:0:*:16384,0:mss,nop,nop,ts:df,id+,ts1-:0
-sig   = *:128:0:*:16384,0:mss,nop,ws,nop,nop,sok:df,id+:0
-sig   = *:128:0:*:16384,0:mss,nop,ws,nop,nop,ts:df,id+,ts1-:0
-sig   = *:128:0:*:16384,0:mss,nop,nop,ts,nop,nop,sok:df,id+,ts1-:0
-sig   = *:128:0:*:16384,0:mss,nop,ws,nop,nop,ts,nop,nop,sok:df,id+,ts1-:0
-
-label = s:win:Windows:7 or 8
-sig   = *:128:0:*:8192,0:mss:df,id+:0
-sig   = *:128:0:*:8192,0:mss,sok,ts:df,id+:0
-sig   = *:128:0:*:8192,8:mss,nop,ws:df,id+:0
-sig   = *:128:0:*:8192,0:mss,nop,nop,ts:df,id+:0
-sig   = *:128:0:*:8192,0:mss,nop,nop,sok:df,id+:0
-sig   = *:128:0:*:8192,8:mss,nop,ws,sok,ts:df,id+:0
-sig   = *:128:0:*:8192,8:mss,nop,ws,nop,nop,ts:df,id+:0
-sig   = *:128:0:*:8192,8:mss,nop,ws,nop,nop,sok:df,id+:0
-
-; -------
-; FreeBSD
-; -------
-
-label = s:unix:FreeBSD:9.x
-sig   = *:64:0:*:65535,6:mss,nop,ws:df,id+:0
-sig   = *:64:0:*:65535,6:mss,nop,ws,sok,ts:df,id+:0
-sig   = *:64:0:*:65535,6:mss,nop,ws,sok,eol+1:df,id+:0
-sig   = *:64:0:*:65535,6:mss,nop,ws,nop,nop,ts:df,id+:0
-
-label = s:unix:FreeBSD:8.x
-sig   = *:64:0:*:65535,3:mss,nop,ws:df,id+:0
-sig   = *:64:0:*:65535,3:mss,nop,ws,sok,ts:df,id+:0
-sig   = *:64:0:*:65535,3:mss,nop,ws,sok,eol+1:df,id+:0
-sig   = *:64:0:*:65535,3:mss,nop,ws,nop,nop,ts:df,id+:0
-
-label = s:unix:FreeBSD:8.x-9.x
-sig   = *:64:0:*:65535,0:mss,sok,ts:df,id+:0
-sig   = *:64:0:*:65535,0:mss,sok,eol+1:df,id+:0
-sig   = *:64:0:*:65535,0:mss,nop,nop,ts:df,id+:0
-
-; -------
-; OpenBSD
-; -------
-
-label = s:unix:OpenBSD:5.x
-sig   = *:64:0:1460:16384,0:mss,nop,nop,sok:df,id+:0
-sig   = *:64:0:1460:16384,3:mss,nop,ws:df,id+:0
-sig   = *:64:0:1460:16384,3:mss,nop,nop,sok,nop,ws:df,id+:0
-sig   = *:64:0:1460:16384,0:mss,nop,nop,ts:df,id+:0
-sig   = *:64:0:1460:16384,0:mss,nop,nop,sok,nop,nop,ts:df,id+:0
-sig   = *:64:0:1460:16384,3:mss,nop,ws,nop,nop,ts:df,id+:0
-sig   = *:64:0:1460:16384,3:mss,nop,nop,sok,nop,ws,nop,nop,ts:df,id+:0
-
-; This one resembles Windows, but almost nobody will be seeing it:
-; sig   = *:64:0:1460:16384,0:mss:df,id+:0
-
-; --------
-; Mac OS X
-; --------
-
-label = s:unix:Mac OS X:10.x
-sig   = *:64:0:*:65535,0:mss,nop,ws:df,id+:0
-sig   = *:64:0:*:65535,0:mss,sok,eol+1:df,id+:0
-sig   = *:64:0:*:65535,0:mss,nop,nop,ts:df,id+:0
-sig   = *:64:0:*:65535,0:mss,nop,ws,sok,eol+1:df,id+:0
-sig   = *:64:0:*:65535,0:mss,nop,ws,nop,nop,ts:df,id+:0
-sig   = *:64:0:*:65535,0:mss,nop,nop,ts,sok,eol+1:df,id+:0
-sig   = *:64:0:*:65535,0:mss,nop,ws,nop,nop,ts,sok,eol+1:df,id+:0
-
-; Ditto:
-; sig   = *:64:0:*:65535,0:mss:df,id+:0
-
-; -------
-; Solaris
-; -------
-
-label = s:unix:Solaris:6
-sig   = 4:255:0:*:mss*7,0:mss:df,id+:0
-sig   = 4:255:0:*:mss*7,0:nop,ws,mss:df,id+:0
-sig   = 4:255:0:*:mss*7,0:nop,nop,ts,mss:df,id+:0
-sig   = 4:255:0:*:mss*7,0:nop,nop,ts,nop,ws,mss:df,id+:0
-
-label = s:unix:Solaris:8
-sig   = *:64:0:*:mss*19,0:mss:df,id+:0
-sig   = *:64:0:*:mss*19,0:nop,ws,mss:df,id+:0
-sig   = *:64:0:*:mss*19,0:nop,nop,ts,mss:df,id+:0
-sig   = *:64:0:*:mss*19,0:nop,nop,sok,mss:df,id+:0
-sig   = *:64:0:*:mss*19,0:nop,nop,ts,nop,ws,mss:df,id+:0
-sig   = *:64:0:*:mss*19,0:nop,ws,nop,nop,sok,mss:df,id+:0
-sig   = *:64:0:*:mss*19,0:nop,nop,ts,nop,nop,sok,mss:df,id+:0
-sig   = *:64:0:*:mss*19,0:nop,nop,ts,nop,ws,nop,nop,sok,mss:df,id+:0
-
-label = s:unix:Solaris:10
-sig   = *:64:0:*:mss*37,0:mss:df,id+:0
-sig   = *:64:0:*:mss*37,0:mss,nop,ws:df,id+:0
-sig   = *:64:0:*:mss*37,0:nop,nop,ts,mss:df,id+:0
-sig   = *:64:0:*:mss*37,0:mss,nop,nop,sok:df,id+:0
-sig   = *:64:0:*:mss*37,0:nop,nop,ts,mss,nop,ws:df,id+:0
-sig   = *:64:0:*:mss*37,0:mss,nop,ws,nop,nop,sok:df,id+:0
-sig   = *:64:0:*:mss*37,0:nop,nop,ts,mss,nop,nop,sok:df,id+:0
-sig   = *:64:0:*:mss*37,0:nop,nop,ts,mss,nop,ws,nop,nop,sok:df,id+:0
-
-; -----
-; HP-UX
-; -----
-
-label = s:unix:HP-UX:11.x
-sig   = *:64:0:*:32768,0:mss:df,id+:0
-sig   = *:64:0:*:32768,0:mss,ws,nop:df,id+:0
-sig   = *:64:0:*:32768,0:mss,nop,nop,ts:df,id+:0
-sig   = *:64:0:*:32768,0:mss,nop,nop,sok:df,id+:0
-sig   = *:64:0:*:32768,0:mss,ws,nop,nop,nop,ts:df,id+:0
-sig   = *:64:0:*:32768,0:mss,nop,nop,sok,ws,nop:df,id+:0
-sig   = *:64:0:*:32768,0:mss,nop,nop,sok,nop,nop,ts:df,id+:0
-sig   = *:64:0:*:32768,0:mss,nop,nop,sok,ws,nop,nop,nop,ts:df,id+:0
-
-; -------
-; OpenVMS
-; -------
-
-label = s:other:OpenVMS:7.x
-sig   = 4:64:0:1460:3993,0:mss::0
-sig   = 4:64:0:1460:3993,0:mss,nop,ws::0
-
-; -----
-; Tru64
-; -----
-
-label = s:unix:Tru64:4.x
-sig   = 4:64:0:1460:mss*25,0:mss,nop,ws:df,id+:0
-sig   = 4:64:0:1460:mss*25,0:mss:df,id+:0
+; We don't use these since we don't need to fingerprint remote hosts
 
 ; ======================
 ; HTTP client signatures
 ; ======================
 
-; Safari and Firefox are frequently seen using HTTP/1.0 when going through
-; proxies; this is far less common for MSIE, Chrome, etc. I wildcarded some of
-; the signatures accordingly.
-;
-; Also note that there are several proxies that mess with HTTP headers for no
-; reason. For example, BlueCoat proxy appears to change 'keep-alive' to
-; 'Keep-Alive' for a tiny percentage of users (why?!).
-
 [http:request]
 
-ua_os = Linux,Windows,iOS=[iPad],iOS=[iPhone],iOS=[iPod],Mac OS X,FreeBSD,OpenBSD,NetBSD,Solaris=[SunOS]
+ua_os = Linux,Windows,iOS=[iPad],iOS=[iPhone],iOS=[iPod],Mac_OS_X,FreeBSD,OpenBSD,NetBSD,Solaris=[SunOS],Nintendo=[Nintendo 3DS],Playstation=[PS Vita],Playstation=[PLAYSTATION],Playstation=[PS3Update],Playstation=[PS3Application],Xbox=[XBox],Xbox=[Xbox],Xbox=[Xenon]
 
 ; -------
 ; Firefox
 ; -------
 
-label = s:!:Firefox:2.x
-sys   = Windows,@unix
-sig   = *:Host,User-Agent,Accept=[,*/*;q=],?Accept-Language,Accept-Encoding=[gzip,deflate],Accept-Charset=[utf-8;q=0.7,*;q=0.7],Keep-Alive=[300],Connection=[keep-alive]::Firefox/
-
-label = s:!:Firefox:3.x
-sys   = Windows,@unix
-sig   = *:Host,User-Agent,Accept=[,*/*;q=],?Accept-Language,Accept-Encoding=[gzip,deflate],Accept-Charset=[utf-8;q=0.7,*;q=0.7],Keep-Alive=[115],Connection=[keep-alive],?Referer::Firefox/
-
-label = s:!:Firefox:4.x
-sys   = Windows,@unix
-sig   = *:Host,User-Agent,Accept=[,*/*;q=],?Accept-Language,Accept-Encoding=[gzip, deflate],Accept-Charset=[utf-8;q=0.7,*;q=0.7],Keep-Alive=[115],Connection=[keep-alive],?Referer::Firefox/
-
-; I have no idea where this 'UTF-8' variant comes from, but it happens on *BSD.
-; Likewise, no clue why Referer is in a different place for some users.
-
-label = s:!:Firefox:5.x-9.x
-sys   = Windows,@unix
-sig   = *:Host,User-Agent,Accept=[,*/*;q=],?Accept-Language,Accept-Encoding=[gzip, deflate],Accept-Charset=[utf-8;q=0.7,*;q=0.7],?DNT=[1],Connection=[keep-alive],?Referer:Keep-Alive:Firefox/
-sig   = *:Host,User-Agent,Accept=[,*/*;q=],?Accept-Language,Accept-Encoding=[gzip, deflate],Accept-Charset=[UTF-8,*],?DNT=[1],Connection=[keep-alive],?Referer:Keep-Alive:Firefox/
-sig   = *:Host,User-Agent,Accept=[,*/*;q=],?Accept-Language,Accept-Encoding=[gzip, deflate],Accept-Charset=[UTF-8,*],?DNT=[1],?Referer,Connection=[keep-alive]:Keep-Alive:Firefox/
-sig   = *:Host,User-Agent,Accept=[,*/*;q=],?Accept-Language,Accept-Encoding=[gzip, deflate],Accept-Charset=[utf-8;q=0.7,*;q=0.7],?DNT=[1],?Referer,Connection=[keep-alive]:Keep-Alive:Firefox/
-sig   = *:Host,User-Agent,Accept=[,*/*;q=],?Accept-Language,Accept-Encoding=[gzip, deflate],Accept-Charset=[utf-8;q=0.7,*;q=0.7],?Referer,?DNT=[1],Connection=[keep-alive]:Keep-Alive:Firefox/
-
-label = s:!:Firefox:10.x or newer
+label = s:!:Firefox:10.x_or_newer
 sys   = Windows,@unix
 sig   = *:Host,User-Agent,Accept=[,*/*;q=],?Accept-Language=[;q=],Accept-Encoding=[gzip, deflate],?DNT=[1],Connection=[keep-alive],?Referer:Accept-Charset,Keep-Alive:Firefox/
 sig   = *:Host,User-Agent,Accept=[,*/*;q=],?Accept-Language=[;q=],Accept-Encoding=[gzip, deflate],?DNT=[1],?Referer,Connection=[keep-alive]:Accept-Charset,Keep-Alive:Firefox/
 
-; There is this one weird case where Firefox 10.x is indistinguishable
-; from Safari 5.1:
-
-label = s:!:Firefox:10.x or Safari 5.x
+label = s:!:Firefox:2x.x_or_newer
 sys   = Windows,@unix
-sig   = *:Host,User-Agent,Accept=[xml;q=0.9,*/*;q=0.8],Accept-Language,Accept-Encoding=[gzip, deflate],Connection=[keep-alive]:Keep-Alive,Accept-Charset,DNT,Referer:Gecko
+sig   = 1:Host,User-Agent=[Firefox/],Accept=[*/*],Accept-Language,Accept-Encoding=[gzip, deflate],?Referer,Connection=[keep-alive],?If-Modified-Since:Accept-Charset,Keep-Alive:Firefox/
 
 ; ---
 ; iOS
@@ -626,6 +420,22 @@
 sig   = 1:User-Agent=[iPhone6,1]::iPhone6,1
 sig   = 1:User-Agent=[iPhone6,2]::iPhone6,2
 
+label = s:!:iPhone:6plus
+sys   = iOS
+sig   = 1:User-Agent=[iPhone7,1]::iPhone7,1
+
+label = s:!:iPhone:6
+sys   = iOS
+sig   = 1:User-Agent=[iPhone7,2]::iPhone7,2
+
+label = s:!:iPhone:6s
+sys   = iOS
+sig   = 1:User-Agent=[iPhone8,1]::iPhone8,1
+
+label = s:!:iPhone:6splus
+sys   = iOS
+sig   = 1:User-Agent=[iPhone8,2]::iPhone8,2
+
 label = s:!:iPad:2
 sys   = iOS
 sig   = 1:User-Agent=[iPad2,1]::iPad2,1
@@ -647,17 +457,37 @@
 sig   = 1:User-Agent=[iPad4,1]::iPad4,1
 sig   = 1:User-Agent=[iPad4,2]::iPad4,2
 
+label = s:!:iPad:Air2
+sys   = iOS
+sig   = 1:User-Agent=[iPad5,3]::iPad5,3
+sig   = 1:User-Agent=[iPad5,4]::iPad5,4
+
 label = s:!:iPad:Mini
 sys   = iOS
 sig   = 1:User-Agent=[iPad2,5]::iPad2,5
 sig   = 1:User-Agent=[iPad2,6]::iPad2,6
 sig   = 1:User-Agent=[iPad2,7]::iPad2,7
 
-label = s:!:iPad:MiniRetina
+label = s:!:iPad:Mini2
 sys   = iOS
 sig   = 1:User-Agent=[iPad4,4]::iPad4,4
 sig   = 1:User-Agent=[iPad4,5]::iPad4,5
 
+label = s:!:iPad:Mini3
+sys   = iOS
+sig   = 1:User-Agent=[iPad4,7]::iPad4,7
+sig   = 1:User-Agent=[iPad4,8]::iPad4,8
+sig   = 1:User-Agent=[iPad4,9]::iPad4,9
+
+label = s:!:iPad:Mini4
+sys   = iOS
+sig   = 1:User-Agent=[iPad5,1]::iPad5,1
+sig   = 1:User-Agent=[iPad5,2]::iPad5,2
+
+label = s:!:iPad:Pro
+sys   = iOS
+sig   = 1:User-Agent=[iPad6,8]::iPad6,8
+
 label = s:!:iPad:
 sys   = iOS
 sig   = 1:User-Agent=[iPad;]::iPad;
@@ -683,17 +513,41 @@
 ; MSIE
 ; ----
 
-; MSIE 11 no longer sends the 'MSIE' part in U-A, but we don't consider
-; U-A to be a robust signal for fingerprinting, so no dice.
+label = s:!:MSIE:XboxOne
+sys   = Windows
+sig   = 1:Accept=[*/*],Accept-Language,UA-CPU=[AMD64],Accept-Encoding=[gzip, deflate],User-Agent=[Xbox One],Host,?DNT,Connection=[Keep-Alive]:Accept-Charset,Keep-Alive:Xbox One
+
+
+label = s:!:MSIE:WinRT
+sys   = Windows
+sig   = 1:Accept,Accept-Language,?Referer,x-flash-version,UA-CPU=[ARM],Accept-Encoding=[gzip, deflate],User-Agent,Host,?DNT,Connection=[Keep-Alive]:Accept-Charset,Keep-Alive:Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.2; ARM; Trident/6.0; Touch)
+sig   = 1:Accept,?Referer,Accept-Language,User-Agent,UA-CPU=[ARM],Accept-Encoding=[gzip, deflate],Host,?DNT,Connection=[Keep-Alive],?Cookie:Accept-Charset,Keep-Alive:Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.2; ARM; Trident/6.0; Touch)
+
+label = s:!:MSIE:11
+sys   = Windows
+sig   = 0:User-Agent=[Mozilla/4.0 (compatible; MSIE 11.],Host,Connection=[Keep-Alive],?Cookie:Accept,Accept-Encoding,Accept-Language,Accept-Charset,Keep-Alive:Mozilla/4.0 (compatible; MSIE 11.
+sig   = 1:User-Agent=[Mozilla/4.0 (compatible; MSIE 11.],Host,Connection=[Keep-Alive],?Cookie:Accept,Accept-Encoding,Accept-Language,Accept-Charset,Keep-Alive:Mozilla/4.0 (compatible; MSIE 11.
+
+label = s:!:MSIE:10
+sys   = Windows
+sig   = 1:Accept,?Referer,Accept-Language,User-Agent=[(compatible; MSIE 10],Accept-Encoding=[gzip, deflate],Host,?DNT,Connection=[Keep-Alive]:Accept-Charset,Keep-Alive:(compatible; MSIE 10
+sig   = 1:Accept=[*/*],Accept-Language,?Referer,?x-flash-version,Accept-Encoding=[gzip, deflate],User-Agent=[(compatible; MSIE 10],Host,?If-Modified-Since,?DNT,Connection=[Keep-Alive]:Accept-Charset,Keep-Alive:(compatible; MSIE 10
+
+label = s:!:MSIE:9
+sys   = Windows
+sig   = 1:Accept-Language,User-Agent=[Mozilla/4.0 (compatible; MSIE 9],Host,Connection=[Keep-Alive]:Accept,Accept-Encoding,Accept-Charset,Keep-Alive:Mozilla/4.0 (compatible; MSIE 9
+sig   = 1:Host,User-Agent=[Mozilla/5.0 (compatible; MSIE 9],Accept-Encoding=[gzip],Accept-Language,?Cookie,Connection=[Close]:Accept,Accept-Charset,Keep-Alive:Mozilla/5.0 (MSIE 9
+sig   = 1:Connection=[Keep-Alive],Pragma=[no-cache],Accept=[*/*],User-Agent=[Mozilla/4.0 (compatible; MSIE 9],Host:Accept-Encoding,Accept-Language,Accept-Charset,Keep-Alive:Mozilla/4.0 (compatible; MSIE 9
 
-label = s:!:MSIE:8 or newer
+label = s:!:MSIE:8
 sys   = Windows
-sig   = 1:Accept=[*/*],?Referer,?Accept-Language,User-Agent,Accept-Encoding=[gzip, deflate],Host,Connection=[Keep-Alive]:Keep-Alive,Accept-Charset,UA-CPU:Trident/
-sig   = 1:Accept=[*/*],?Referer,?Accept-Language,Accept-Encoding=[gzip, deflate],User-Agent,Host,Connection=[Keep-Alive]:Keep-Alive,Accept-Charset:(compatible; MSIE
+sig   = 1:Accept=[*/*],?Referer,?Accept-Language,User-Agent=[Mozilla/4.0 (compatible; MSIE 8],Accept-Encoding=[gzip, deflate],Host,Connection=[Keep-Alive]:Keep-Alive,Accept-Charset,UA-CPU:Mozilla/4.0 (compatible; MSIE 8
+sig   = 1:Accept=[*/*],?Referer,?Accept-Language,Accept-Encoding=[gzip, deflate],User-Agent=[Mozilla/4.0 (compatible; MSIE 8],Host,Connection=[Keep-Alive]:Keep-Alive,Accept-Charset:Mozilla/4.0 (compatible; MSIE 8
 
 label = s:!:MSIE:7
 sys   = Windows
-sig   = 1:Accept=[*/*],?Referer,?Accept-Language,UA-CPU,User-Agent,Accept-Encoding=[gzip, deflate],Host,Connection=[Keep-Alive]:Keep-Alive,Accept-Charset:(compatible; MSIE
+sig   = 1:Accept=[*/*],?Referer,?Accept-Language,?UA-CPU,User-Agent=[(compatible; MSIE 7],Accept-Encoding=[gzip, deflate],Host,Connection=[Keep-Alive]:Keep-Alive,Accept-Charset:(compatible; MSIE 7
+sig   = 1:Accept=[*/*],?Referer,Accept-Language,Accept-Encoding=[gzip, deflate],User-Agent=[Mozilla/4.0 (compatible; MSIE 7],Host,Connection=[Keep-Alive],?Cookie:Accept-Charset,Keep-Alive:Mozilla/4.0 (compatible; MSIE 7
 
 ; TODO: Check if this one ever uses Accept-Language, etc. Also try to find MSIE 5.
 
@@ -702,23 +556,342 @@
 sig   = 0:Accept=[*/*],?Referer,User-Agent,Host:Keep-Alive,Connection,Accept-Encoding,Accept-Language,Accept-Charset:(compatible; MSIE
 sig   = 1:Accept=[*/*],Connection=[Keep-Alive],Host,?Pragma=[no-cache],?Range,?Referer,User-Agent:Keep-Alive,Accept-Encoding,Accept-Language,Accept-Charset:(compatible; MSIE
 
+label = s:!:DynGate:
+sys   = Windows
+sig   = 1:User-Agent=[Mozilla/4.0 (compatible; MSIE 6.0; DynGate)],Host,Accept=[*/*]:Connection,Accept-Encoding,Accept-Language,Accept-Charset,Keep-Alive:Mozilla/4.0 (compatible; MSIE 6.0; DynGate)
+
 ; ------
 ; Chrome
 ; ------
 
+label = s:!:Chrome:Chrome_OS
+sys   = Linux
+sig   = 1:User-Agent=[Mozilla/5.0 (X11; CrOS]::Mozilla/5.0 (X11; CrOS
+
 label = s:!:Chrome:Android
 sys   = @unix
 sig   = 1:Host,Connection=[keep-alive],User-Agent=[Linux; Android],Accept=[text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8],?Referer,Accept-Encoding=[gzip,deflate,sdch],Accept-Language,Accept-Charset=[ISO-8859-1,utf-8;q=0.7,*;q=0.3],?Cookie:Keep-Alive:Linux; Android 4
 
-label = s:!:Chrome:11.x to 26.x
+label = s:!:Chrome:11_or_newer
 sys   = Windows,@unix
 sig   = 1:Host,Connection=[keep-alive],User-Agent,Accept=[*/*],?Referer,Accept-Encoding=[gzip,deflate,sdch],Accept-Language,Accept-Charset=[utf-8;q=0.7,*;q=0.3]:: Chrom
 sig   = 1:Host,Connection=[keep-alive],User-Agent,Accept=[*/*],?Referer,Accept-Encoding=[gzip,deflate,sdch],Accept-Language,Accept-Charset=[UTF-8,*;q=0.5]:: Chrom
 sig   = 1:Host,User-Agent,Accept=[*/*],?Referer,Accept-Encoding=[gzip,deflate,sdch],Accept-Language,Accept-Charset=[utf-8;q=0.7,*;q=0.3],Connection=[keep-alive]::Chrom
+sig   = 1:Host,Connection=[keep-alive],?Accept,?X-Rlz-String,User-Agent=[Chrome],?Referer,Accept-Encoding=[gzip,deflate,sdch],Accept-Language:Accept-Charset,Keep-Alive:Chrome
+sig   = 1:Host,Connection=[keep-alive],?Cache-Control,?Accept,User-Agent=[Chrome],X-Rlz-String,?X-Chrome-Variations,Accept-Encoding=[gzip,deflate,sdch],Accept-Language=[en-US,en;q=0.8],?Cookie:Accept-Charset,Keep-Alive:Chrome
 
-label = s:!:Chrome:27.x or newer
-sys   = Windows,@unix
-sig   = 1:Host,Connection=[keep-alive],Accept=[*/*],User-Agent,?Referer,Accept-Encoding=[gzip,deflate,sdch],Accept-Language:Accept-Charset,Keep-Alive: Chrom
+; --------------
+; Model-specific Android browser
+; ---------------
+
+; Nexus S
+label = s:!:Nexus:S
+sys   = Linux
+sig   = 1:User-Agent=[; Nexus S 4G Build]::Nexus S 4G Build
+sig   = 1:User-Agent=[; Nexus S Build]::Nexus S Build
+
+; Galaxy S
+label = s:!:Samsung:GalaxyS
+sys   = Linux
+sig   = 1:User-Agent=[SCH-R760]::SCH-R760
+
+; Galaxy S II
+label = s:!:Samsung:GalaxySII
+sys   = Linux
+sig   = 1:User-Agent=[GT-I9100]::GT-I9100
+sig   = 1:User-Agent=[SPH-D710]::SPH-D710
+sig   = 1:User-Agent=[SGH-T989]::SGH-T989
+
+; Galaxy S III
+label = s:!:Samsung:GalaxySIII
+sys   = Linux
+sig   = 1:User-Agent=[SCH-R530]::SCH-R530
+sig   = 1:User-Agent=[GT-I9300]::GT-I9300
+sig   = 1:User-Agent=[GT-I9305]::GT-I9305
+sig   = 1:User-Agent=[SHV-E210]::SHV-E210
+sig   = 1:User-Agent=[SGH-T999]::SGH-T999
+sig   = 1:User-Agent=[SGH-I747]::SGH-I747
+sig   = 1:User-Agent=[SGH-N064]::SGH-N064
+sig   = 1:User-Agent=[SGN-N035]::SGN-N035
+sig   = 1:User-Agent=[SCH-J021]::SCH-J021
+sig   = 1:User-Agent=[SCH-I535]::SCH-I535
+sig   = 1:User-Agent=[SPH-L710]::SPH-L710
+sig   = 1:User-Agent=[GT-I9308]::GT-I9308
+sig   = 1:User-Agent=[SCH-I939]::SCH-I939
+; Galaxy S III mini
+sig   = 1:User-Agent=[GT-I8190]::GT-I8190
+
+; Galaxy S4
+label = s:!:Samsung:GalaxyS4
+sys   = Linux
+sig   = 1:User-Agent=[SGH-M919]::SGH-M919
+sig   = 1:User-Agent=[GT-I9500]::GT-I9500
+sig   = 1:User-Agent=[GT-I9505]::GT-I9505
+sig   = 1:User-Agent=[SHV-E300]::SHV-E300
+sig   = 1:User-Agent=[GT-I9506]::GT-I9506
+sig   = 1:User-Agent=[SGH-I337]::SGH-I337
+sig   = 1:User-Agent=[SCH-I545]::SCH-I545
+sig   = 1:User-Agent=[SPH-L720]::SPH-L720
+sig   = 1:User-Agent=[SCH-R970]::SCH-R970
+sig   = 1:User-Agent=[GT-I9508]::GT-I9508
+sig   = 1:User-Agent=[SCH-I959]::SCH-I959
+sig   = 1:User-Agent=[GT-I9502]::GT-I9502
+sig   = 1:User-Agent=[SGH-N045]::SGH-N045
+; S4 Active
+sig   = 1:User-Agent=[SGH-I537]::SGH-I537
+sig   = 1:User-Agent=[SHV-E470S]::SHV-E470S
+; S4 Zoom
+sig   = 1:User-Agent=[SM-C105A]::SM-C105A
+
+; Galaxy S4 Mini
+label = s:!:Samsung:GalaxyS4Mini
+sys   = Linux
+sig   = 1:User-Agent=[GT-I9190]::GT-I9190
+sig   = 1:User-Agent=[GT-I9195]::GT-I9195
+sig   = 1:User-Agent=[GT-I9192]::GT-I9192
+sig   = 1:User-Agent=[GT-I9198]::GT-I9198
+sig   = 1:User-Agent=[SPH-L520]::SPH-L520
+sig   = 1:User-Agent=[SCH-I435]::SCH-I435
+
+; Galaxy S5
+label = s:!:Samsung:GalaxyS5
+sys   = Linux
+sig   = 1:User-Agent=[SM-G900]::SM-G900
+
+; Galaxy Nexus
+label = s:!:Samsung:GalaxyNexus
+sys   = Linux
+sig   = 1:User-Agent=[Galaxy Nexus]::Galaxy Nexus
+
+label = s:!:Samsung:GalaxyNote
+sys   = Linux
+sig   = 1:User-Agent=[; GT-N7000 Build]::; GT-N7000 Build
+sig   = 1:User-Agent=[; SAMSUNG-SGH-I717 Build]::; SAMSUNG-SGH-I717 Build
+sig   = 1:User-Agent=[GT-N7000B]::GT-N7000B
+sig   = 1:User-Agent=[GT-N7005]::GT-N7005
+sig   = 1:User-Agent=[SHV-E160K]::SHV-E160K
+sig   = 1:User-Agent=[SHV-E160L]::SHV-E160L
+sig   = 1:User-Agent=[SHV-E160S]::SHV-E160S
+sig   = 1:User-Agent=[SC-05D]::SC-05D
+sig   = 1:User-Agent=[SGH-T879]::SGH-T879
+sig   = 1:User-Agent=[GT-I9220]::GT-I9220
+sig   = 1:User-Agent=[GT-I9228]::GT-I9228
+sig   = 1:User-Agent=[SCH-I889]::SCH-I889
+
+
+label = s:!:Samsung:GalaxyNoteII
+sys   = Linux
+sig   = 1:User-Agent=[; SCH-I605 Build]::; SCH-I605 Build
+sig   = 1:User-Agent=[GT-N7100]::GT-N7100
+sig   = 1:User-Agent=[GT-N7102]::GT-N7102
+sig   = 1:User-Agent=[GT-N7105]::GT-N7105
+sig   = 1:User-Agent=[GT-N7108]::GT-N7108
+sig   = 1:User-Agent=[SCH-R950]::SCH-R950
+sig   = 1:User-Agent=[SGH-I317]::SGH-I317
+sig   = 1:User-Agent=[SGH-T889]::SGH-T889
+sig   = 1:User-Agent=[SPH-L900]::SPH-L900
+sig   = 1:User-Agent=[SCH-N719]::SCH-N719
+sig   = 1:User-Agent=[SGH-N025]::SGH-N025
+sig   = 1:User-Agent=[SC-02E]::SC-02E
+sig   = 1:User-Agent=[SHV-E250K]::SHV-E250K
+sig   = 1:User-Agent=[SHV-E250L]::SHV-E250L
+sig   = 1:User-Agent=[SHV-E250S]::SHV-E250S
+
+label = s:!:Samsung:GalaxyNote3
+sys   = Linux
+sig   = 1:User-Agent=[SM-N900]::SM-N900
+
+label = s:!:Samsung:GalaxyTab
+sys   = Linux
+sig   = 1:User-Agent=[; GT-P]::; GT-P
+sig   = 1:User-Agent=[; SM-T]::; SM-T
+sig   = 1:User-Agent=[; SAMSUNG-SM-T]::; SAMSUNG-SM-T
+
+label = s:!:Samsung:GalaxyNoteTablet
+sys   = Linux
+sig   = 1:User-Agent=[GT-N5110]::GT-N5110
+sig   = 1:User-Agent=[GT-N8013]::GT-N8013
+
+label = s:!:Samsung:SmartTV
+sys   = Linux
+sig   = 1:Host,User-Agent=[Linux/SmartTV;SmartTV Safari/],Accept=[*/*],Accept-Encoding=[gzip, deflate],Connection=[Keep-Alive]:Accept-Language,Accept-Charset,Keep-Alive:Linux/SmartTV;SmartTV Safari/
+sig   = 1:DUID,MACAddr,ModelId,Category,Param,CountryCode,Host,Connection=[close]:User-Agent,Accept,Accept-Encoding,Accept-Language,Accept-Charset,Keep-Alive:
+sig   = 1:Host,Connection=[close],User-Agent=[SmartHub; SMART-TV],Content-Type=[text/xml],cache-control=[no-cache],Accept=[*/*],Accept-Encoding=[gzip, deflate],Content-Length=[0]:Accept-Language,Accept-Charset,Keep-Alive:SmartHub; SMART-TV
+sig   = 1:Host,User-Agent=[SmartHub; SMART-TV],?Cookie,Accept=[*/*],Accept-Encoding=[gzip, deflate],Connection=[Keep-Alive]:Accept-Language,Accept-Charset,Keep-Alive:SmartHub; SMART-TV
+sig    = 1:User-Agent=[Maple 5.1.00266 Navi]::Maple 5.1.00266 Navi
+sig    = 1:User-Agent=[Maple 6.0.00077 Navi]::Maple 6.0.00077 Navi
+
+label = s:!:Motorola:DROID_4
+sys   = Linux
+sig   = 1:User-Agent=[; DROID4 Build]::; DROID4 Build
+
+label = s:!:Motorola:DROID_Bionic
+sys   = Linux
+sig   = 1:User-Agent=[; DROID BIONIC Build]::; DROID BIONIC Build
+
+label = s:!:Motorola:DROID_RAZR
+sys   = Linux
+sig   = 1:User-Agent=[DROID RAZR Build]::DROID RAZR Build
+
+label = s:!:Motorola:DROID_RAZR_HD
+sys   = Linux
+sig   = 1:User-Agent=[DROID RAZR HD Build]::DROID RAZR HD Build
+
+label = s:!:Motorola:DROID_Ultra
+sys   = Linux
+sig   = 1:User-Agent=[XT1080 Build]::XT1080 Build
+
+label = s:!:Motorola:DROID_M
+sys   = Linux
+sig   = 1:User-Agent=[XT907 Build]::XT907 Build
+
+label = s:!:Motorola:Moto_X
+sys   = Linux
+sig   = 1:User-Agent=[XT1053 Build]::XT1053 Build
+sig   = 1:User-Agent=[XT1055 Build]::XT1055 Build
+sig   = 1:User-Agent=[XT1056 Build]::XT1056 Build
+sig   = 1:User-Agent=[XT1060 Build]::XT1060 Build
+
+label = s:!:Motorola:DROID_MINI
+sys   = Linux
+sig   = 1:User-Agent=[XT1030 Build]::XT1030 Build
+
+label = s:!:Motorola:Moto_G
+sys   = Linux
+sig   = 1:User-Agent=[XT1032 Build]::XT1032 Build
+
+label = s:!:HTC:One
+sys   = Linux
+sig   = 1:User-Agent=[HTC One Build]::HTC One Build
+sig   = 1:User-Agent=[HTC_One Build]::HTC_One Build
+sig   = 1:User-Agent=[HTC One 801e Build]::HTC One 801e Build
+sig   = 1:User-Agent=[; HTCONE Build]::; HTCONE Build
+sig   = 1:User-Agent=[; HTC6500LVW Build]::; HTC6500LVW Build
+
+label = s:!:HTC:One_M8
+sys   = Linux
+sig   = 1:User-Agent=[HTC One_M8 Build]::HTC One_M8 Build
+
+label = s:!:HTC:One_X
+sys   = Linux
+sig   = 1:User-Agent=[HTC One X Build]::HTC One X Build
+
+label = s:!:HTC:One_S
+sys   = Linux
+sig   = 1:User-Agent=[; HTC_One_S Build]::; HTC_One_S Build
+sig   = 1:User-Agent=[; HTC One S Build]::; HTC One S Build
+
+label = s:!:HTC:ThunderBolt
+sys   = Linux
+sig   = 1:User-Agent=[ADR6400L Build]::ADR6400L Build
+
+label = s:!:HTC:Shift_4G
+sys   = Linux
+sig   = 1:User-Agent=[PG06100 Build]::PG06100 Build
+
+label = s:!:HTC:J
+sys   = Linux
+sig   = 1:User-Agent=[HTC_J_Z321e Build]::HTC_J_Z321e Build
+sig   = 1:User-Agent=[; HTC J Z321e Build]::; HTC J Z321e Build
+
+label = s:!:HTC:Amaze_4G
+sys   = Linux
+sig   = 1:User-Agent=[HTC_Amaze_4G Build]::HTC_Amaze_4G Build
+
+label = s:!:HTC:Rhyme
+sys   = Linux
+sig   = 1:User-Agent=[; ADR6330VW Build]::; ADR6330VW Build
+
+label = s:!:HTC:Rezound
+sys   = Linux
+sig   = 1:User-Agent=[; ADR6425LVW Build]::; ADR6425LVW Build
+
+label = s:!:HTC:EVO
+sys   = Linux
+sig   = 1:User-Agent=[; EVO Build]::; EVO Build
+
+label = s:!:HTC:Droid_DNA
+sys   = Linux
+sig   = 1:User-Agent=[; HTC6435LVW Build]::; EVO Build
+
+label = s:!:Sony:Xperia_go
+sys   = Linux
+sig   = 1:User-Agent=[ST27i Build]::ST27i Build
+sig   = 1:User-Agent=[ST27a Build]::ST27a Build
+
+label = s:!:Sony:Xperia_Z1
+sys   = Linux
+sig   = 1:User-Agent=[C6903 Build]::C6903 Build
+; Z1s
+sig   = 1:User-Agent=[C6916 Build]::C6916 Build
+
+label = s:!:Sony:Xperia_Z2
+sys   = Linux
+sig   = 1:User-Agent=[D6503 Build]::D6503 Build
+
+label = s:!:Sony:Xperia_Z
+sys   = Linux
+sig   = 1:User-Agent=[; C6603 Build]::; C6603 Build
+sig   = 1:User-Agent=[; C6602 Build]::; C6602 Build
+
+label = s:!:Sony:Xperia_Tablet_Z
+sys   = Linux
+sig   = 1:User-Agent=[; SGP311 Build]::; SGP311 Build
+sig   = 1:User-Agent=[; SGP312 Build]::; SGP312 Build
+sig   = 1:User-Agent=[; SGP321 Build]::; SGP321 Build
+
+label = s:!:Nexus:10
+sys   = Linux
+sig   = 1:User-Agent=[; Nexus 10 Build]::; Nexus 10 Build
+
+label = s:!:Nexus:5
+sys   = Linux
+sig   = 1:User-Agent=[; Nexus 5 Build]::; Nexus 5 Build
+
+label = s:!:Nexus:7
+sys   = Linux
+sig   = 1:User-Agent=[; Nexus 7 Build]::; Nexus 7 Build
+
+label = s:!:Nexus:4
+sys   = Linux
+sig   = 1:User-Agent=[; Nexus 4 Build]::; Nexus 4 Build
+
+label = s:!:Kindle:Fire
+sys   = Linux
+sig   = 1:User-Agent=[; KFTT Build]::; KFTT Build
+sig   = 1:User-Agent=[; Kindle Fire Build]::; Kindle Fire Build
+
+label = s:!:Kindle:Fire_HD
+sys   = Linux
+sig   = 1:User-Agent=[; KFJWI Build]::; KFJWI Build
+
+label = s:!:Kindle:Fire_HDX
+sys   = Linux
+sig   = 1:User-Agent=[; KFTHWI Build]::; KFTHWI Build
+sig   = 1:User-Agent=[; KFAPWI Build]::; KFAPWI Build
+
+label = s:!:ASUS:MeMOPad
+sys   = Linux
+; HD 7-Inch
+sig   = 1:User-Agent=[; ME173X Build]::; ME173X Build
+
+label = s:!:Amazon:Fire_TV
+sys   = Linux
+sig   = 1:User-Agent=[; AFTB Build]::; AFTB Build
+
+label = s:!:LG:G2
+sys   = Linux
+sig   = 1:User-Agent=[; LG-LS980 Build]::; LG-LS980 Build
+sig   = 1:User-Agent=[; LG-D800 Build]::; LG-D800 Build
+
+label = s:!:LG:G_Pro_2
+sys   = Linux
+sig   = 1:User-Agent=[; LG-D838 Build]::; LG-D838 Build
+
+; Generic Android Tablet
+label = s:!:Generic:Tablet
+sys   = Linux
+sig   = 1:User-Agent=[; NX008HD Build]::; NX008HD Build
 
 ; ---------------
 ; Android browser
@@ -787,293 +960,428 @@
 sys   = Linux
 sig   = 1:User-Agent=[Android]::Android
 
-; -----
-; Opera
-; -----
+; ----------
+; BlackBerry
+; ----------
+
+label = s:!:BlackBerry:9220
+sys   = BlackBerry
+sig   = 1:Host,Connection=[Keep-Alive],?Cache-Control,User-Agent,X-Wap-Proxy-Cookie=[none],SP-UA=[BlackBerry 9220]:Accept,Accept-Encoding,Accept-Language,Accept-Charset,Keep-Alive:BlackBerry 9220
 
-label = s:!:Opera:19.x or newer
-sys   = Windows,@unix
-sig   = 1:Host,Connection=[keep-alive],Accept=[*/*;q=0.8],User-Agent,Accept-Encoding=[gzip,deflate,lzma,sdch],Accept-Language=[;q=0.]:Accept-Charset,Keep-Alive:OPR/
 
-label = s:!:Opera:15.x-18.x
-sys   = Windows,@unix
-sig   = 1:Host,Connection=[keep-alive],Accept=[*/*;q=0.8],User-Agent,Accept-Encoding=[gzip, deflate],Accept-Language=[;q=0.]:Accept-Charset,Keep-Alive:OPR/
+; -------------------
+; Playstation 3 browser
+; -------------------
 
-label = s:!:Opera:11.x-14.x
-sys   = Windows,@unix
-sig   = 1:User-Agent,Host,Accept=[*/*;q=0.1],?Accept-Language=[;q=0.],Accept-Encoding=[gzip, deflate],Connection=[Keep-Alive]:Accept-Charset,X-OperaMini-Phone-UA:) Presto/
+label = s:!:Playstation:3
+sys   = Playstation
+sig   = 1:Host,Connection=[Keep-Alive],?Cookie,Accept-Encoding=[identity],x-ps3-browser,Accept-Language,User-Agent=[PLAYSTATION 3]:Accept,Accept-Charset,Keep-Alive:PLAYSTATION 3
+sig   = 1:Host,User-Agent=[PS3Application],Connection=[Keep-Alive],Accept-Encoding=[identity]:Accept,Accept-Language,Accept-Charset,Keep-Alive:PS3Application
+sig   = 1:Host,Connection=[Keep-Alive],Accept-Encoding=[identity],User-Agent=[PS3Update-agent]:Accept,Accept-Language,Accept-Charset,Keep-Alive:PS3Update-agent
+sig   = 1:User-Agent=[Playstation3]::Playstation3
+sig   = 1:User-Agent=[PS3ThumnailGet]::PS3ThumnailGet
+sig   = 1:Accept=[*/*],Host,?Range,X-Device=[NFPS3-]:User-Agent,Connection,Accept-Encoding,Accept-Language,Accept-Charset,Keep-Alive:
 
-label = s:!:Opera:10.x
-sys   = Windows,@unix
-sig   = 1:User-Agent,Host,Accept=[*/*;q=0.1],Accept-Language=[;q=0.],Accept-Charset=[utf-8, utf-16, *;q=0.1],Accept-Encoding=[deflate, gzip, x-gzip, identity, *;q=0],Connection=[Keep-Alive]::Presto/
-sig   = 1:User-Agent,Host,Accept=[*/*;q=0.1],Accept-Language=[en],Accept-Encoding=[gzip, deflate],Connection=[Keep-Alive]:Accept-Charset:Opera/
+; -------------------
+; Playstation 4 browser
+; -------------------
+label = s:!:Playstation:4
+sys   = FreeBSD
+sig   = 1:User-Agent=[(PlayStation 4)]::(PlayStation 4)
 
-label = s:!:Opera:Mini
-sys   = Linux
-sig   = 1:User-Agent,Host,Accept=[*/*;q=0.1],Accept-Language=[;q=0.],Accept-Encoding=[gzip, deflate],Connection=[Keep-Alive],X-OperaMini-Phone-UA,X-OperaMini-Features,X-OperaMini-Phone,x-forwarded-for:Accept-Charset:Opera Mini/
+; -------------------
+; PS Vita browser
+; -------------------
+label = s:!:Playstation:Vita
+sys   = Playstation
+sig   = 1:?If-Modified-Since,Host,User-Agent=[PS Vita],Connection=[Keep-Alive]:Accept,Accept-Encoding,Accept-Charset,Keep-Alive:PS Vita
+
+; --------------------
+; Nintendo
+; --------------------
 
-label = s:!:Opera:on Nintendo Wii
+label = s:!:Nintendo:3DS
 sys   = Nintendo
-sig   = 1:User-Agent,Host,Accept=[*/*;q=0.1],Accept-Language=[en],Accept-Charset=[iso-8859-1, utf-8, utf-16, *;q=0.1],Accept-Encoding=[deflate, gzip, x-gzip, identity, *;q=0],Connection=[Keep-Alive]::Nintendo
+sig   = 1:Host,User-Agent,HTTP_X_GAMEID,Content-Type=[application/x-www-form-urlencoded],Connection=[Close]:Accept,Accept-Encoding,Accept-Language,Accept-Charset,Keep-Alive:CTR
+sig   = 1:User-Agent=[Nintendo 3DS]::Nintendo 3DS
+; Specified on Nintendo's web site
+
+label = s:!:Nintendo:WiiU
+sys   = @other
+sig   = 1:Accept=[*/*],Host,?Range,X-Device=[NFWIIU-]:User-Agent,Connection,Accept-Encoding,Accept-Language,Accept-Charset,Keep-Alive:
+sig   = 1:User-Agent=[Nintendo WiiU/],Host,Accept=[*/*],?Cookie,?Range:Connection,Accept-Encoding,Accept-Language,Accept-Charset,Keep-Alive:Nintendo WiiU/
+sig   = 1:User-Agent=[PBOSU-3.0/],Host,Accept=[*/*]:Connection,Accept-Encoding,Accept-Language,Accept-Charset,Keep-Alive:PBOSU-3.0/
+sig   = 1:Host=[pushmore.wup.shop.nintendo.net],Accept=[*/*]:User-Agent,Connection,Accept-Encoding,Accept-Language,Accept-Charset,Keep-Alive:
 
-; ------
-; Safari
-; ------
+; ---------
+; WebClient
+; ---------
+
+label = s:!:WebClient:Xbox
+sys   = Xbox
+sig   = 1:User-Agent=[Mozilla/4.0 (compatible; NativeHost)],Connection=[Keep-alive],Host,?Referer:Accept,Accept-Encoding,Accept-Language,Accept-Charset,Keep-Alive:Mozilla/4.0 (compatible; NativeHost)
+
+; ---------
+; Xbox 360
+; ---------
 
-label = s:!:Safari:7 or newer
+label = s:!:Xbox:360
+sys   = Xbox
+sig   = 1:User-Agent=[Xbox/2],Connection=[Keep-alive],Host:Accept,Accept-Encoding,Accept-Language,Accept-Charset,Keep-Alive:Xbox/2
+sig   = 1:User-Agent=[Xbox 360],Connection=[Keep-alive],Host:Accept,Accept-Encoding,Accept-Language,Accept-Charset,Keep-Alive:Xbox 360
+sig   = 1:User-Agent=[Xbox Live Client/2],Connection=[Keep-alive],Host:Accept,Accept-Encoding,Accept-Language,Accept-Charset,Keep-Alive:Xbox Live Client/2
+sig   = 1:User-Agent=[Xenon],Connection=[Keep-alive],Host,RANGE=[bytes=]:Accept,Accept-Encoding,Accept-Language,Accept-Charset,Keep-Alive:Xenon
+sig   = 1:User-Agent=[Zune Video (Xbox)],Connection=[Keep-alive],Host:Accept,Accept-Encoding,Accept-Language,Accept-Charset,Keep-Alive:Zune Video (XBox)
+
+; ---------
+; Mac App Store
+; ---------
+
+label = s:!:Mac_OS_X:AppStore
 sys   = @unix
-sig   = *:Host,Accept-Encoding=[gzip, deflate],Connection=[keep-alive],Accept=[*/*],User-Agent,Accept-Language,?Referer,?DNT:Accept-Charset,Keep-Alive:KHTML, like Gecko)
+sig   = 1:Host,User-Agent=[(x86_64) (Mac],Accept=[*/*],Accept-Language,Accept-Encoding=[gzip, deflate],Connection=[keep-alive]:Accept-Charset,Keep-Alive:(x86_64) (Mac
 
-label = s:!:Safari:5.1-6
-sys   = Windows,@unix
-sig   = *:Host,User-Agent,Accept=[*/*],?Referer,Accept-Language,Accept-Encoding=[gzip, deflate],Connection=[keep-alive]:Accept-Charset:KHTML, like Gecko)
-sig   = *:Host,User-Agent,Accept=[*/*],?Referer,Accept-Encoding=[gzip, deflate],Accept-Language,Connection=[keep-alive]:Accept-Charset:KHTML, like Gecko)
+; ---------
+; Mac Safari and Chrome
+; ---------
 
-label = s:!:Safari:5.0 or earlier
-sys   = Mac OS X
-sig   = 0:Host,User-Agent,Connection=[close]:Accept,Accept-Encoding,Accept-Language,Accept-Charset:CFNetwork/
+label = s:!:Mac_OS_X:Safari_or_Chrome
+sys   = @unix
+sig   = 1:User-Agent=[(Macintosh;]::(Macintosh;
 
 ; ---------
-; Konqueror
+; Killer Network Manager
 ; ---------
 
-label = s:!:Konqueror:4.6 or earlier
-sys   = Linux,FreeBSD,OpenBSD
-sig   = 1:Host,Connection=[Keep-Alive],User-Agent,?Pragma,?Cache-control,Accept=[*/*],Accept-Encoding=[x-gzip, x-deflate, gzip, deflate],Accept-Charset=[;q=0.5, *;q=0.5],Accept-Language::Konqueror/
-
-label = s:!:Konqueror:4.7 or newer
-sys   = Linux,FreeBSD,OpenBSD
-sig   = 1:Host,Connection=[keep-alive],User-Agent,Accept=[*/*],Accept-Encoding=[gzip, deflate, x-gzip, x-deflate],Accept-Charset=[,*;q=0.5],Accept-Language::Konqueror/
+label = s:!:Killer_Network_Manager:
+sys   = @win
+sig   = 1:User-Agent=[Bigfoot-Killer Network Manager/],Connection=[Keep-Alive],Accept-Encoding=[gzip],Accept-Language=[en-US,*],Host:Accept,Accept-Charset,Keep-Alive:Bigfoot-Killer Network Manager/
 
-; -------------------
-; Major search robots
-; -------------------
+; ------
+; Linksys Phone Adapter
+; ------
+
+label = s:!:Linksys:PhoneAdapter
+sys   = PH_Linksys
+sig   = 0:Host,User-Agent=[Linksys/SPA],Connection=[close]:Accept,Accept-Encoding,Accept-Language,Accept-Charset,Keep-Alive:Linksys/SPA
+
+; ------
+; Obihai
+; ------
 
-label = s:!:BaiduSpider:
-sys   = BaiduSpider
-sig   = 1:Host,Connection=[close],User-Agent,Accept=[*/*]:Accept-Encoding,Accept-Language,Accept-Charset:Baiduspider-image
-sig   = 1:Host,Accept-Language=[zh-cn],Connection=[close],User-Agent:Accept,Accept-Encoding,Accept-Charset:Baiduspider
-sig   = 1:Host,Connection=[close],User-Agent,Accept-Language=[zh-cn,zh-tw],Accept-Encoding=[gzip],Accept=[*/*]:Accept-Charset:Baiduspider
-sig   = 1:Host,Connection=[close],User-Agent,Accept-Language=[tr-TR],Accept-Encoding=[gzip],Accept=[*/*]:Accept-Charset:Baiduspider
-sig   = 1:Host,Connection=[close],User-Agent,Accept-Encoding=[gzip],?Accept-Language=[zh-cn,zh-tw],Accept=[*/*]:Accept-Charset:Baiduspider
-sig   = 1:Host,Connection=[close],User-Agent,Accept-Encoding=[gzip],Accept-Language=[tr-TR],Accept=[*/*]:Accept-Charset:Baiduspider
-
-label = s:!:Googlebot:
-sys   = Linux
-sig   = 1:Host,Connection=[Keep-alive],Accept=[*/*],From=[googlebot(at)googlebot.com],User-Agent,Accept-Encoding=[gzip,deflate],?If-Modified-Since:Accept-Language,Accept-Charset:Googlebot
-sig   = 1:Host,Connection=[Keep-alive],Accept=[text/plain],Accept=[text/html],From=[googlebot(at)googlebot.com],User-Agent,Accept-Encoding=[gzip,deflate]:Accept-Language,Accept-Charset:Googlebot
+label = s:!:Obihai:VoIP
+sys   = PH_Obihai
+sig   = 1:Host,User-Agent=[OBi],?Cache-Control,Accept-Language=[en-us, en],Accept-Charset=[ISO-8859-1, utf-8],Connection=[Close]:Accept,Accept-Encoding,Keep-Alive:OBi
+
+; --
+; HP
+; --
+
+label = s:!:HP:InkjetUpdate
+sys   = PH_1
+sig   = 1:Host,Accept-Encoding=[identity;q=1.0, *;q=0],User-Agent=[HP-Inkjet-WebUpdate]:Connection,Accept,Accept-Language,Accept-Charset,Keep-Alive:HP-Inkjet-WebUpdate
 
-label = s:!:Googlebot:feed fetcher
+; ----
+; TiVo
+; ----
+
+label = s:!:TiVo:
 sys   = Linux
-sig   = 1:Host,Connection=[Keep-alive],Accept=[*/*],User-Agent,Accept-Encoding=[gzip,deflate],?If-Modified-Since:Accept-Language,Accept-Charset:-Google
-sig   = 1:User-Agent,?X-shindig-dos=[on],Cache-Control,Host,?X-Forwarded-For,Accept-Encoding=[gzip],?Accept-Language:Connection,Accept,Accept-Charset:Feedfetcher-Google
+sig   = 0:User-Agent,Host,TiVo_TCD_ID,TiVo_SW_VER:Connection,Accept,Accept-Encoding,Accept-Language,Accept-Charset,Keep-Alive:TmkHttpRequest/1.0
+sig   = 0:User-Agent,TiVo_TCD_ID,TiVo_SW_VER:Host,Connection,Accept,Accept-Encoding,Accept-Language,Accept-Charset,Keep-Alive:TmkHttpRequest/1.0
 
-label = s:!:Bingbot:
-sys   = Windows
-sig   = 1:Cache-Control,Connection=[Keep-Alive],Pragma=[no-cache],Accept=[*/*],Accept-Encoding,Host,User-Agent:Accept-Language,Accept-Charset:bingbot/
+; ------
+; Vonage
+; ------
 
-; MSNbot has a really silly Accept header, only a tiny part of which is preserved here:
+label = s:!:Vonage:VDV2
+sys   = OpenBSD
+sig   = 1:User-Agent=[VDV2],Host,Connection=[Keep-Alive]:Accept,Accept-Encoding,Accept-Language,Accept-Charset,Keep-Alive:VDV2
 
-label = s:!:MSNbot:
-sys   = Windows
-sig   = 1:Connection=[Close],Accept,Accept-Encoding=[gzip, deflate],From=[msnbot(at)microsoft.com],Host,User-Agent:Accept-Language,Accept-Charset:msnbot
+; -----
+; Sling
+; -----
+; These may not be specific enough, but we require OS match too
 
-label = s:!:Yandex:crawler
-sys   = FreeBSD
-sig   = 1:Host,Connection=[Keep-Alive],Accept=[*/*],Accept-Encoding=[gzip,deflate],Accept-Language=[en-us, en;q=0.7, *;q=0.01],User-Agent,From=[support@search.yandex.ru]:Accept-Charset:YandexBot/
-sig   = 1:Host,Connection=[Keep-Alive],Accept=[image/jpeg, image/pjpeg, image/png, image/gif],User-Agent,From=[support@search.yandex.ru]:Accept-Encoding,Accept-Language,Accept-Charset:YandexImages/
-sig   = 1:Host,Connection=[Keep-Alive],User-Agent,From=[support@search.yandex.ru]:Accept,Accept-Encoding,Accept-Language,Accept-Charset:YandexBot/
+label = s:!:Sling:
+sys   = Sling
+sig   = 1:User-Agent,Host,Accept=[application/json]:Connection,Accept-Encoding,Accept-Language,Accept-Charset,Keep-Alive:
 
-label = s:!:Yahoo:crawler
-sys   = Linux
-sig   = 0:Host,User-Agent,Accept=[,image/png,*/*;q=0.5],Accept-Language=[en-us,en;q=0.5],Accept-Encoding=[gzip],Accept-Charset=[,utf-8;q=0.7,*;q=0.7]:Connection:Slurp
+; -----
+; Kodak
+; -----
 
-; -----------------
-; Misc other robots
-; -----------------
+label = s:!:AVOS:
+sys   = Kodak
+sig   = 1:User-Agent=[AVOS],Host,DeviceToken:Connection,Accept,Accept-Encoding,Accept-Language,Accept-Charset,Keep-Alive:AVOS/1.1 libhttp/1.1
 
-label = s:!:Flipboard:crawler
-sys   = Linux
-sig   = 1:User-Agent,Accept-Language=[en-us,en;q=0.5],Accept-Charset=[;q=0.7,*;q=0.5],Accept-Encoding=[gzip],Host,Accept=[*; q=.2, */*; q=.2],Connection=[keep-alive]::FlipboardProxy
-sig   = 1:Accept-language=[en-us,en;q=0.5],Accept-encoding=[gzip],Accept=[;q=0.9,*/*;q=0.8],User-agent,Host:User-Agent,Connection,Accept-Encoding,Accept-Language,Accept-Charset:FlipboardProxy
+; --------
+; Motorola
+; --------
 
-label = s:!:Spinn3r:crawler
-sys   = Linux
-sig   = 1:User-Agent,Accept-Encoding=[gzip],Host,Accept=[*; q=.2, */*; q=.2],Connection=[close]:Accept-Language,Accept-Charset:Spinn3r
+label = s:!:Motorola:DCT
+sys   = PH_Motorola
+sig   = 1:Host,User-Agent=[Motorola-DCT],Connection=[close]:Accept,Accept-Encoding,Accept-Language,Accept-Charset,Keep-Alive:Motorola-DCT
 
-label = s:!:Facebook:crawler
-sys   = Linux
-sig   = 1:User-Agent,Host,Accept=[*/*],Accept-Encoding=[deflate, gzip],Connection=[close]:Accept-Language,Accept-Charset:facebookexternalhit/
-sig   = 1:User-Agent,Host,Accept=[*/*],Connection=[close]:Accept-Encoding,Accept-Language,Accept-Charset:facebookexternalhit/
+; --------
+; Magicjack
+; --------
+label = s:!:Magicjack:
+sys   = OpenBSD
+sig   = 0:Connection=[Keep-Alive],Host,User-Agent,Content-Length=[0]:Accept,Accept-Encoding,Accept-Language,Accept-Charset,Keep-Alive:mJ
 
-label = s:!:paper.li:crawler
+; -------
+; DirecTV
+; -------
+label = s:!:DirecTV:
 sys   = Linux
-sig   = 1:Accept-Language=[en-us,en;q=0.5],Accept=[*/*],User-Agent,Connection=[close],Accept-Encoding=[gzip,identity],?Referer,Host,Accept-Charset=[ISO-8859-1,utf-8;q=0.7,*;q=0.7]::PaperLiBot/
+sig   = 0:Accept=[text/*, image/*, video/*],Host=[dtvbb.tv]:User-Agent,Connection,Accept-Encoding,Accept-Language,Accept-Charset,Keep-Alive:
 
-label = s:!:Twitter:crawler
-sys   = Linux
-sig   = 1:User-Agent=[Twitterbot/],Host,Accept=[*; q=.2, */*; q=.2],Cache-Control,Connection=[keep-alive]:Accept-Encoding,Accept-Language,Accept-Charset:Twitterbot/
+; -----
+; Frontier Silicon
+; -----
+label = s:!:Frontier:radio
+sys   = PH_Frontier
+sig   = 1:Host,User-Agent=[FSL IR/],?Cache-Control,Pragma=[no-cache]:Connection,Accept,Accept-Encoding,Accept-Language,Accept-Charset,Keep-Alive:FSL IR/
+sig   = 0:Host,User-Agent=[FSL IR/]:Connection,Accept,Accept-Encoding,Accept-Language,Accept-Charset,Keep-Alive:FSL IR/
 
-label = s:!:linkdex:crawler
-sys   = Linux
-sig   = 0:Host,Connection=[Keep-Alive],User-Agent,Accept-Encoding=[gzip,deflate]:Accept,Accept-Language,Accept-Charset:linkdex.com/
+; ---
+; Synology
+; ---
+label = s:!:Synology:
+sys   = PH_Synology
+sig   = 1:Accept=[*/*],Host=[checkip.synology.com]:User-Agent,Connection,Accept-Encoding,Accept-Language,Accept-Charset,Keep-Alive:
+sig   = 0:User-Agent=[synology_],Accept=[*/*],Host,Connection=[Keep-Alive]:Accept-Encoding,Accept-Language,Accept-Charset,Keep-Alive:synology_
 
-label = s:!:Yodaobot:
-sys   = Linux
-sig   = 1:Accept-Encoding=[identity;q=0.5, *;q=0.1],User-Agent,Host:Connection,Accept,Accept-Language,Accept-Charset:YodaoBot/
+; ---
+; Swann (security)
+; ---
+label = s:!:Swann:DVR
+sys   = Nest
+sig   = 1:Host=[mydvr.swanndvr.com],User-Agent,?Authorization,Connection=[close]:Accept,Accept-Encoding,Accept-Language,Accept-Charset,Keep-Alive:Wget
+
+; --------------
+; Minimal client
+; --------------
+
+label = s:!:Minimal:
+sys   = @other
+sig   = 0::Host,User-Agent,Connection,Accept,Accept-Encoding,Accept-Language,Accept-Charset,Keep-Alive:
 
-label = s:!:Tweetmeme:crawler
-sys   = Linux
-sig   = 1:Host,User-Agent,Accept=[,image/png,*/*;q=0.5],Accept-Language=[en-gb,en;q=0.5],Accept-Charset=[ISO-8859-1,utf-8;q=0.7,*;q=0.7]:Connection,Accept-Encoding:TweetmemeBot/
+; ---
+; Kindle Classic
+; ---
 
-label = s:!:Archive.org:crawler
-sys   = Linux
-sig   = 0:User-Agent,Connection=[close],Accept=[application/xml;q=0.9,*/*;q=0.8],Host:Accept-Encoding,Accept-Language,Accept-Charset:archive.org
+label = s:!:Kindle:Classic
+sys   = Kindle
+sig   = 1:?Accept-Language,?X-ADP-SW,User-Agent=[Java/phoneme_advanced],Host,Accept,Connection=[keep-alive]:Accept-Encoding,Accept-Charset,Keep-Alive:Java/phoneme_advanced-Core-1.3-b03
 
-label = s:!:Yahoo Pipes:
+; ---
+; Vizio
+; ---
+
+label = s:!:Vizio:
 sys   = Linux
-sig   = 0:Client-IP,X-Forwarded-For,X-YQL-Depth,User-Agent,Host,Connection=[keep-alive],Via:Accept,Accept-Encoding,Accept-Language,Accept-Charset:Yahoo Pipes
-sig   = 1:Client-IP,X-Forwarded-For,X-YQL-Depth,User-Agent,Host,Via:Connection,Accept,Accept-Encoding,Accept-Language,Accept-Charset:Yahoo Pipes
+sig   = 1:Host,Accept=[*/*],User-Agent=[Vizio]:Connection,Accept-Encoding,Accept-Language,Accept-Charset,Keep-Alive:Vizio
+; Too broad
+; sig   = 1:User-Agent,Host,Accept=[*/*]:Connection,Accept-Encoding,Accept-Language,Accept-Charset,Keep-Alive:Mozilla/5.0
+
+; ---
+; Roku
+; ---
 
-label = s:!:Google Web Preview:
+label = s:!:Roku:
 sys   = Linux
-sig   = 1:Referer,User-Agent,Accept-Encoding=[gzip,deflate],Host,X-Forwarded-For:Connection,Accept,Accept-Language,Accept-Charset:Web Preview
+sig   = 1:Connection=[close],Host,User-Agent=[Roku]:Accept,Accept-Encoding,Accept-Language,Accept-Charset,Keep-Alive:Roku
+sig   = 1:Host,User-Agent=[Roku]:Connection,Accept,Accept-Encoding,Accept-Language,Accept-Charset,Keep-Alive:Roku
 
-; --------------------------------
-; Command-line tools and libraries
-; --------------------------------
+; ---
+; Boxee
+; ---
 
-label = s:!:wget:
-sys   = @unix,Windows
-sig   = *:User-Agent,Accept=[*/*],Host,Connection=[Keep-Alive]:Accept-Encoding,Accept-Language,Accept-Charset:Wget/
+label = s:!:Boxee:
+sys   = Linux
+sig   = 1:User-Agent,Host,Accept=[*/*],Accept-Encoding=[deflate, gzip],?Cookie,Accept-Charset=[ISO-8859-1,utf-8;q=0.7,*;q=0.7],Accept-Language=[en-us,en;q=0.5],Keep-Alive=[300],Connection=[keep-alive],X-Boxee-Client-Id::boxee
+sig   = 1:User-Agent=[; Boxee/],?Cookie,Connection=[Keep-Alive],Accept-Encoding=[gzip],Accept-Language=[en,*],Host:Accept,Accept-Charset,Keep-Alive:; Boxee/
 
-label = s:!:Lynx:
-sys   = @unix,Windows
-sig   = 0:Host,Accept=[text/sgml, */*;q=0.01],Accept-Encoding=[gzip, compress],Accept-Language,User-Agent:Connection,Accept-Charset:Lynx/
+; ---
+; Nest
+; ---
 
-label = s:!:curl:
-sys   = @unix,Windows
-sig   = 1:User-Agent,Host,Accept=[*/*]:Connection,Accept-Encoding,Accept-Language,Accept-Charset:curl/
+label = s:!:Nest:
+sys   = Nest
+sig   = 1:User-Agent=[AddLightness],Host,Accept=[*/*]:Connection,Accept-Encoding,Accept-Language,Accept-Charset,Keep-Alive:AddLightness
 
-label = s:!:links:
-sys   = @unix,Windows
-sig   = 1:Host,User-Agent,Accept=[*/*],Accept-Encoding=[gzip, deflate, bzip2],Accept-Charset=[us-ascii],Accept-Language=[;q=0.1],Connection=[Keep-Alive]::Links
-sig   = 1:Host,User-Agent,Accept=[*/*],Accept-Encoding=[gzip,deflate,bzip2],Accept-Charset=[us-ascii],Accept-Language=[;q=0.1],Connection=[keep-alive]::Links
+; ---
+; A/V Equipment
+; ---
 
-label = s:!:elinks:
-sys   = @unix,Windows
-sig   = 1:Host,User-Agent,Accept=[*/*],Accept-Encoding=[bzip2, deflate, gzip],Accept-Language:Connection,Accept-Charset:ELinks/
+label = s:!:Panasonic:
+sys   = FreeBSD
+sig   = 1:User-Agent=[U2FsdGVkX1],Host,Accept=[*/*],Accept-Charset=[utf-8]:Connection,Accept-Encoding,Accept-Language,Keep-Alive:U2FsdGVkX1
+sig   = 1:User-Agent,Host=[vieraconnect.tv],Accept=[*/*],Pragma=[no-cache],?Cache-Control:Connection,Accept-Encoding,Accept-Language,Accept-Charset,Keep-Alive:
 
-label = s:!:Java:JRE
-sys   = @unix,@win
-sig   = 1:User-Agent,Host,Accept=[*; q=.2, */*; q=.2],Connection=[keep-alive]:Accept-Encoding,Accept-Language,Accept-Charset:Java/
+label = s:!:Yamaha:AVR
+sys   = Yamaha
+sig   = 1:Host,User-Agent=[AV_Receiver/],Accept=[*/*],?Content-Length,Connection=[close]:Accept-Language,Accept-Charset,Keep-Alive:AV_Receiver/
+
+label = s:!:Sony:TV
+sys   = Sony
+sig   = 1:Host,Accept=[*/*],X-WS-COUNTRY-CODE=[USA],X-WS-LANGUAGE-CODE,User-Agent:Connection,Accept-Encoding,Accept-Language,Accept-Charset,Keep-Alive:WidgetSystem/4.0.4
+sig   = 1:User-Agent=[SONY DTV/],Host,Accept=[*/*]:Connection,Accept-Encoding,Accept-Language,Accept-Charset,Keep-Alive:SONY DTV/
+sig   = 1:Host,Accept=[*/*],?Cache-Control,User-Agent=[Sony BRAVIA]:Connection,Accept-Encoding,Accept-Language,Accept-Charset,Keep-Alive:Sony BRAVIA
+sig   = 1:Host=[bravia-e.dl.playstation.net],Accept=[*/*]:User-Agent,Connection,Accept-Encoding,Accept-Language,Accept-Charset,Keep-Alive:
+
+label = s:!:Sony:KDL-55HX850
+sys   = Sony
+sig   = 1:Host,Accept=[*/*],X-WS-MODEL-NAME=[KDL-55HX850],X-WS-CLIENT-ID,X-WS-COUNTRY-CODE,X-WS-LANGUAGE-CODE,User-Agent:Connection,Accept-Encoding,Accept-Language,Accept-Charset,Keep-Alive:WidgetSystem/4.0.4
+
+label = s:!:Sony:KDL-55W900A
+sys   = Sony
+sig   = 1:Host,Accept=[*/*],?Cache-Control,User-Agent=[BRAVIA KDL-55W900A]:Connection,Accept-Encoding,Accept-Language,Accept-Charset,Keep-Alive:Sony BRAVIA KDL-55W900A
+
+label = s:!:Sony:BD
+sys   = Sony
+sig   = 1:?Range,User-Agent=[SONY BD/],Host,Accept=[*/*]:Connection,Accept-Encoding,Accept-Language,Accept-Charset,Keep-Alive:SONY BD/
+sig   = 1:Host,Accept=[*/*],?Cookie,User-Agent=[SONY BD/]:Connection,Accept-Encoding,Accept-Language,Accept-Charset,Keep-Alive:SONY BD/
+
+label = s:!:Sony:Receiver
+sys   = PH_NinSling
+sig   = 1:Host,Connection=[close],User-Agent=[SONY HA-STR/],Accept=[*/*]:Accept-Encoding,Accept-Language,Accept-Charset,Keep-Alive:SONY HA-STR/
+sig   = 1:Host,Connection=[close],User-Agent=[L1.0#STR-],Accept=[*/*]:Accept-Encoding,Accept-Language,Accept-Charset,Keep-Alive:L1.0#STR-
+
+; Samsung over-the-network update
+label = s:!:Samsung:OTN
+sys   = Linux
+sig   = 1:Host=[samsungotn.net],?If-Modified-Since,DUID:User-Agent,Connection,Accept,Accept-Encoding,Accept-Language,Accept-Charset,Keep-Alive:
+
+label = s:!:Sharp:Aquos
+sys   = PH_Arcadyan
+sig   = 0:User-Agent=[AQUOS HTM_TIME],?Cache-Control,Host:Connection,Accept,Accept-Encoding,Accept-Language,Accept-Charset,Keep-Alive:AQUOS HTM_TIME
+sig   = 1:Host,User-Agent=[AQUOS_DL/],Pragma=[no-cache],Accept=[*/*]:Connection,Accept-Encoding,Accept-Language,Accept-Charset,Keep-Alive:AQUOS_DL/
+
+label = s:!:Sharp:LE830
+sys   = PH_Arcadyan
+sig   = 1:User-Agent=[(DEVTYPE=SH-TVLE830;],Content-Type,Connection=[Keep-Alive],Accept-Encoding=[gzip],Host:Accept,Accept-Charset,Keep-Alive:(DEVTYPE=SH-TVLE830;
 
-label = s:!:Python:urllib
-sys   = @unix,Windows
-sig   = 1:Accept-Encoding=[identity],Host,Connection=[close],User-Agent:Accept,Accept-Language,Accept-Charset:Python-urllib/
+; ---
+; Symbian
+; ---
 
-label = s:!:w3m:
-sys   = @unix,Windows
-sig   = 0:User-Agent,Accept=[image/*],Accept-Encoding=[gzip, compress, bzip, bzip2, deflate],Accept-Language=[;q=1.0],Host:Connection,Accept-Charset:w3m/
+label = s:!:Symbian:
+sys   = Symbian
+sig   = 1:Connection=[Keep-Alive],Host,Accept,Accept-Charset,Accept-Encoding=[gzip, deflate, x-gzip, identity; q=0.9],Accept-Language,?Cookie,?Cookie2,?Referer,User-Agent,X-Nokia-MusicShop-Bearer,PnP,X-Nokia-MusicShop-Version,x-wap-profile:Keep-Alive:SymbianOS/9
+
+label = s:!:Symbian:E72
+sys   = Symbian
+sig   =  1:Connection=[Keep-Alive],Host,Accept,Accept-Charset,Accept-Encoding=[gzip, deflate, x-gzip, identity; q=0.9],Accept-Language,?Cookie,?Cookie2,User-Agent=[Mozilla/5.0 (SymbianOS/9.3; Series60/3.2 NokiaE72],PnP,X-Nokia-MusicShop-Bearer,X-Nokia-MusicShop-Version,x-wap-profile:Keep-Alive:Mozilla/5.0 (SymbianOS/9.3; Series60/3.2 NokiaE72
 
-label = s:!:libfetch:
-sys   = @unix
-sig   = 1:Host,User-Agent,Connection=[close]:Accept,Accept-Encoding,Accept-Language,Accept-Charset:libfetch/
+; ---
+; Windows Phone
+; ---
 
-; -------------
-; Odds and ends
-; -------------
+label = s:!:Nokia:Lumia_928
+sys   = Windows
+sig   = 1:User-Agent=[NOKIA; Lumia 928]::NOKIA; Lumia 928
 
-label = s:!:Google AppEngine:
-sys   = Linux
-sig   = 1:User-Agent,Host,Accept-Encoding=[gzip]:Connection,Accept,Accept-Language,Accept-Charset:AppEngine-Google
+label = s:!:Nokia:Lumia_920
+sys   = Windows
+sig   = 1:User-Agent=[NOKIA; Lumia 920]::NOKIA; Lumia 920
 
-label = s:!:WebOS:
-sys   = Linux
-sig   = 1:Host,Accept-Encoding=[gzip, deflate],User-Agent,Accept=[,*/*;q=0.5],Accept-Language,Accept-Charset=[utf-8;q=0.7,*;q=0.3]:Connection:wOSBrowser
+label = s:!:Nokia:Lumia_822
+sys   = Windows
+sig   = 1:User-Agent=[NOKIA; Lumia 822]::NOKIA; Lumia 822
 
-label = s:!:xxxterm:
-sys   = @unix
-sig   = 1:Host,User-Agent,Accept=[*/*],Accept-Encoding=[gzip]:Connection,Accept-Language,Accept-Charset:xxxterm
+label = s:!:Nokia:Lumia_521
+sys   = Windows
+sig   = 1:User-Agent=[NOKIA; Lumia 521]::NOKIA; Lumia 521
 
-label = s:!:Google Desktop:
+label = s:!:Nokia:Lumia_520
 sys   = Windows
-sig   = 1:Accept=[*/*],Accept-Encoding=[gzip],User-Agent,Host,Connection=[Keep-Alive]:Accept-Language,Accept-Charset:Google Desktop/
+sig   = 1:User-Agent=[NOKIA; Lumia 520]::NOKIA; Lumia 520
 
-label = s:!:luakit:
-sys   = @unix
-sig   = 1:Host,User-Agent,Accept=[*/*],Accept-Encoding=[gzip],Connection=[Keep-Alive]:Accept-Language,Accept-Charset:luakit
+; The semicolon in the UA is to prevent p0f from complaining about duplicate sigs
+label = s:!:Nokia:Lumia
+sys   = Windows
+sig   = 1:User-Agent=[; NOKIA; Lumia]::; NOKIA; Lumia
 
-label = s:!:Epiphany:
-sys   = @unix
-sig   = 1:Host,User-Agent,Accept=[*/*],Accept-Encoding=[gzip],Accept-Language:Connection,Accept-Charset,Keep-Alive:Epiphany/
+label = s:!:WindowsPhone:
+sys   = Windows
+sig   = 1:Connection=[Keep-Alive],Accept=[*/*],If-Range,?Range,User-Agent=[; Windows Mobile],Unless-Modified-Since,Host:Accept-Encoding,Accept-Language,Accept-Charset,Keep-Alive:; Windows Mobile
+sig   = 1:Accept=[*/*],?Referer,Accept-Encoding=[identity],User-Agent=[NativeHost],Host,Connection=[Keep-Alive]:Accept-Language,Accept-Charset,Keep-Alive:NativeHost
 
-; ======================
-; HTTP server signatures
-; ======================
+; ---
+; Netgear
+; ---
 
-[http:response]
+label = s:!:MTK:NeoTV
+sys   = Linux
+sig   = 1:User-Agent=[Mozilla/5.0 (compatible; MTK/1.0)],Host,Accept=[*/*],?Referer,x-flash-version:Connection,Accept-Encoding,Accept-Language,Accept-Charset,Keep-Alive:Mozilla/5.0 (compatible; MTK/1.0)
 
-; ------
-; Apache
-; ------
+label = s:!:NeoTV:update
+sys   = Linux
+sig   = 1:Host=[updates1.netgear.com],Accept=[*/*]:User-Agent,Connection,Accept-Encoding,Accept-Language,Accept-Charset,Keep-Alive:
 
-label = s:!:Apache:2.x
-sys   = @unix,Windows
-sig   = 1:Date,Server,?Last-Modified,?Accept-Ranges=[bytes],?Content-Length,?Content-Range,Keep-Alive=[timeout],Connection=[Keep-Alive],?Transfer-Encoding=[chunked],Content-Type::Apache
-sig   = 1:Date,Server,?Last-Modified,?Accept-Ranges=[bytes],?Content-Length,?Connection=[close],?Transfer-Encoding=[chunked],Content-Type:Keep-Alive:Apache
-sig   = 1:Date,Server,Connection=[Keep-Alive],Keep-Alive=[timeout]:Content-Type,Accept-Ranges:Apache
-sig   = 1:Date,Server,?Last-Modified,?Accept-Ranges=[bytes],?Content-Length,Content-Type,Keep-Alive=[timeout],Connection=[Keep-Alive]::Apache
+label = s:!:NeoTV:speedtest
+sys   = Linux
+sig   = 0:User-Agent=[HTTPing],Host=[ntvs.netgear.com]:Connection,Accept,Accept-Encoding,Accept-Language,Accept-Charset,Keep-Alive:HTTPing
+
+label = s:!:NeoTV:NTV300
+sys   = Linux
+sig   = 1:User-Agent=[NTV300],Host,Accept=[*/*],?Referer,x-flash-version:Connection,Accept-Encoding,Accept-Language,Accept-Charset,Keep-Alive:NTV300
 
-label = s:!:Apache:1.x
-sys   = @unix,Windows
-sig   = 1:Server,Content-Type,?Content-Length,Date,Connection=[keep-alive]:Keep-Alive,Accept-Ranges:Apache
-sig   = 1:Server,Content-Type,?Content-Length,Date,Connection=[close]:Keep-Alive,Accept-Ranges:Apache
+label = s:!:NeoTV:GTV100
+sys   = Linux
+sig   = 1:Host,Connection=[keep-alive],User-Agent=[GTV100 Build],Accept-Encoding=[gzip,deflate,sdch],Accept-Language,Accept-Charset,?Cookie:Keep-Alive:GTV100 Build
 
 ; ---
-; IIS
+; Others
 ; ---
 
-label = s:!:IIS:7.x
-sys   = Windows
-sig   = 1:?Content-Length,Content-Type,?Etag,Server,Date:Connection,Keep-Alive,Accept-Ranges:Microsoft-IIS/
-sig   = 1:?Content-Length,Content-Type,?Etag,Server,Date,Connection=[close]:Keep-Alive,Accept-Ranges:Microsoft-IIS/
+label = s:!:Squeezebox:Server
+sys   = Linux
+sig   = 0:Connection=[close],?Cache-Control,Accept=[*/*],Accept-Encoding=[deflate, gzip],Accept-Language,Host,User-Agent=[Squeezebox Server, Logitech Media Server/],?Cookie,Cookie2,Icy-Metadata:Accept-Charset,Keep-Alive:Squeezebox Server, Logitech Media Server/
+sig   = 0:?Cache-Control,Connection=[close],Accept=[*/*],Host,User-Agent=[SqueezeCenter, Squeezebox Server, Logitech Media Server/],Icy-Metadata=[1]:Accept-Encoding,Accept-Language,Accept-Charset,Keep-Alive:SqueezeCenter, Squeezebox Server, Logitech Media Server/
 
-; --------
-; lighttpd
-; --------
+label = s:!:Nook:
+sys   = Linux
+sig   = 1:Host,Connection=[Keep-Alive],User-Agent=[BN_USER_AGENT]:Accept,Accept-Encoding,Accept-Language,Accept-Charset,Keep-Alive:BN_USER_AGENT
 
-label = s:!:lighttpd:2.x
-sys   = @unix
-sig   = 1:?ETag,?Last-Modified,Accept-Ranges=[bytes],Content-Type,?Vary,?Content-Length,Date,Server:Connection,Keep-Alive:lighttpd/
-sig   = 1:?ETag,?Last-Modified,Transfer-Encoding=[chunked],Content-Type,?Vary,?Content-Length,Date,Server:Connection,Keep-Alive:lighttpd/
+label = s:!:OregonScientific:
+sys   = PH_Oregon
+sig   = 0:Host=[static.oregonscientific.com],Connection=[close]:User-Agent,Accept,Accept-Encoding,Accept-Language,Accept-Charset,Keep-Alive:
 
-label = s:!:lighttpd:1.x
-sys   = @unix
-sig   = 1:Content-Type,Accept-Ranges=[bytes],?ETag,?Last-Modified,Date,Server:Connection,Keep-Alive:lighttpd/
-sig   = 1:Content-Type,Transfer-Encoding=[chunked],?ETag,?Last-Modified,Date,Server:Connection,Keep-Alive:lighttpd/
-sig   = 0:Content-Type,Content-Length,Connection=[close],Date,Server:Keep-Alive,Accept-Ranges:lighttpd/
+; This one is on a HomeWizard, and surely some other b0rked user agents
+label = s:!:b0rked:
+sys   = PH_HomeWizard
+sig   = 1::Host,User-Agent,Connection,Accept,Accept-Encoding,Accept-Language,Accept-Charset,Keep-Alive:
 
-; -----
-; nginx
-; -----
+label = s:!:Sonos:
+sys   = Linux
+sig   = 1:CONNECTION=[close],ACCEPT=[*/*],Host,USER-AGENT=[Sonos]:User-Agent,Connection,Accept,Accept-Encoding,Accept-Language,Accept-Charset,Keep-Alive:
+sig   = 1:CONNECTION=[close],ACCEPT,Host,USER-AGENT=[Sonos/],?If-None-Match:User-Agent,Connection,Accept,Accept-Encoding,Accept-Language,Accept-Charset,Keep-Alive:
 
-label = s:!:nginx:1.x
-sys   = @unix
-sig   = 1:Server,Date,Content-Type,?Content-Length,?Last-Modified,Connection=[keep-alive],Keep-Alive=[timeout],Accept-Ranges=[bytes]::nginx/
-sig   = 1:Server,Date,Content-Type,?Content-Length,?Last-Modified,Connection=[close]:Keep-Alive,Accept-Ranges:nginx/
+label = s:!:Seagate:BlackArmor
+sys   = Linux
+sig   = 1:User-Agent=[arm-mv-linux-gnu],Host=[www.seagate.com],Accept=[*/*]:Connection,Accept-Encoding,Accept-Language,Accept-Charset,Keep-Alive:curl/7.18.2 (arm-mv-linux-gnu) libcurl/7.18.2 GnuTLS/2.4.2 zlib/1.2.3
 
-label = s:!:nginx:0.x
-sys   = @unix
-sig   = 1:Server,Date,Content-Type,?Content-Length,Connection=[keep-alive],?Last-Modified:Keep-Alive,Accept-Ranges:nginx/
-sig   = 1:Server,Date,Content-Type,?Content-Length,Connection=[close],?Last-Modified:Keep-Alive,Accept-Ranges:nginx/
+label = s:!:Chromecast:Netflix
+sys   = Linux
+sig   = 1:Accept=[*/*],Host,?Range,X-Device=[2012.4 GOOGEUR001]:User-Agent,Connection,Accept-Encoding,Accept-Language,Accept-Charset,Keep-Alive:
 
-; -------------
-; Odds and ends
-; -------------
-
-label = s:!:Google Web Server:
-sys   = Linux
-sig   = *:Content-Type,X-Content-Type-Options=[nosniff],Date,Server=[sffe]:Connection,Accept-Ranges,Keep-Alive,Connection:
-sig   = *:Date,Content-Type,Server=[gws]:Connection,Accept-Ranges,Keep-Alive:
-sig   = *:Content-Type,X-Content-Type-Options=[nosniff],Server=[GSE]:Connection,Accept-Ranges,Keep-Alive:
+label = s:!:Chromecast:Mozilla
+sys   = Linux
+sig   =  1:Host,Connection=[keep-alive],Accept=[image/webp,*/*;q=0.8],User-Agent=[Mozilla/5.0 (CrKey],Accept-Encoding=[gzip,deflate],Accept-Language,?Cookie:Accept-Charset,Keep-Alive:Mozilla/5.0 (CrKey
+sig   = 1:Host,Connection=[keep-alive],User-Agent=[CrKey],?Origin,Accept=[*/*],Accept-Encoding=[gzip,deflate],Accept-Language:Accept-Charset,Keep-Alive:CrKey
+sig   = 1:Host,Connection=[keep-alive],Accept,User-Agent=[CrKey],Accept-Encoding=[gzip, deflate],Accept-Language,CAST-DEVICE-CAPABILITIES:Accept-Charset,Keep-Alive:CrKey
+sig   = 1:Host,Connection=[keep-alive],User-Agent=[CrKey],?Origin,Accept=[*/*],Accept-Encoding=[gzip, deflate],Accept-Language,CAST-DEVICE-CAPABILITIES:Accept-Charset,Keep-Alive:CrKey
+
+label = s:!:Debian:NetgearNAS
+sys   = Linux
+sig   = 1:Host=[readynas.com],?Cache-Control,Accept=[text/*],User-Agent=[Debian APT-HTTP]:Connection,Accept-Encoding,Accept-Language,Accept-Charset,Keep-Alive:Debian APT-HTTP/1.3 (1.0.9.2)
+
+; ======================
+; HTTP server signatures
+; ======================
+
+[http:response]
